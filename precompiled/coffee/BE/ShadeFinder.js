(function(){var t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},e={}.hasOwnProperty,n=function(t,e){return function(){return t.apply(e,arguments)}};define("UI.Browser",["$","Model"],function($,e){var n,i,r;return r=function(t){var e;return e={},function(n){return e[n]||(e[n]=t(n)),e[n]}},i=function(t){var e,n,i,r;return e=document.createElement("div"),r=["Khtml","ms","O","Moz","Webkit"],n=r.length,(i=function(t){if(t in e.style)return t;for(t=t.replace(/^[a-z]/,function(t){return t.toUpperCase()});n--;)if(r[n]+t in e.style)return"-"+r[n].toLowerCase()+"-"+t.toLowerCase()})(t)},new(n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={breakpoints:{},breakpoint:void 0,hasMouse:void 0},n.prototype.initialize=function(){var t;return this.win=$(window),this.doc=$(document),this.win.resize(function(t){return function(){return cancelAnimationFrame(t.frame),t.frame=requestAnimationFrame(function(){return t.resize()})}}(this)),this.win.scroll(function(t){return function(){return t.scroll()}}(this)),t=this.debounce(function(t){return function(){return t.mouseend()}}(this),400),this.doc.on("mousemove",function(e){return function(n){return e.mousemove(n),t()}}(this)),this.doc.on("touchmove",function(t){return function(e){return t.touchmove(e)}}(this)),this.doc.on("touchend",function(t){return function(e){return t.touchend(e)}}(this))},n.prototype.is={IOS:function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},touch:function(){return"ontouchstart"in window||"onmsgesturechange"in window},retina:function(){return window.devicePixelRatio>1},firefox:function(){return/(Firefox)/g.test(navigator.userAgent)},windows:function(){return/(Windows)/g.test(navigator.userAgent)},chrome:function(){return/(Chrome)/g.test(navigator.userAgent)},android:function(){return/(Android)/gi.test(navigator.userAgent)},IE10:function(){return/(MSIE 10)/g.test(navigator.userAgent)},IE9:function(){return/(MSIE 9)/g.test(navigator.userAgent)},IE8:function(){return/(MSIE 8)/g.test(navigator.userAgent)}},n.prototype.isnt={IOS:function(){return!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},touch:function(){return!1 in window&&!1 in window},retina:function(){return window.devicePixelRatio<=1},firefox:function(){return!/(Firefox)/g.test(navigator.userAgent)},windows:function(){return!/(Windows)/g.test(navigator.userAgent)},chrome:function(){return!/(Chrome)/g.test(navigator.userAgent)},android:function(){return!/(Android)/gi.test(navigator.userAgent)},IE10:function(){return!/(MSIE 10)/g.test(navigator.userAgent)},IE9:function(){return!/(MSIE 9)/g.test(navigator.userAgent)},IE8:function(){return!/(MSIE 8)/g.test(navigator.userAgent)}},n.prototype.breakpoint=function(t){return this.set({breakpoints:t}),this.on("resize",function(t){return function(e){var n,i,r,o;i=t.get("breakpoints"),r=[];for(n in i){if(o=i[n],o>e.width){t.set({breakpoint:n});break}r.push(void 0)}return r}}(this)),this},n.prototype.data=function(){var t,e,n,i,r;return r=this.win,n=this.doc.scrollTop(),t=r.height(),e=window.innerHeight,e<t&&(t=e),i=r.width(),{top:n,height:t,width:i,center:n+t/2,bottom:n+t}},n.prototype.resize=function(){return this.trigger("resize",this.data()),clearTimeout(this.transitionTimeout),this.transitionTimeout=setTimeout(function(t){return function(){return t.trigger("resize",t.data())}}(this),500),this},n.prototype.scroll=function(){return this.trigger("scroll",{top:this.doc.scrollTop()}),this},n.prototype.mousemove=function(t){if(this.mousing=this.mousing||[t.pageX,t.pageY],Math.abs(t.pageX-this.mousing[0])+Math.abs(t.pageY-this.mousing[1])>40)return this.set({input:"mouse"})},n.prototype.mouseend=function(t){return delete this.mousing},n.prototype.touchmove=function(t){var e;if(e=t.originalEvent.touches[0],this.touching=this.touching||[e.pageX,e.pageY],Math.abs(e.pageX-this.touching[0])+Math.abs(e.pageY-this.touching[1])>40)return this.set({input:"touch"})},n.prototype.touchend=function(t){return delete this.touching},n.prototype.memoize=r,n.prototype.has=r(i),n.prototype.debounce=function(t,e,n){var i,r,o,s,a;return s=void 0,i=void 0,r=void 0,a=void 0,o=void 0,function(){var u,c;return r=this,i=arguments,a=new Date,c=function(u){return function(){var u;return u=new Date-a,u<e?s=setTimeout(c,e-u):(s=null,n?void 0:o=t.apply(r,i))}}(this),u=n&&!s,s||(s=setTimeout(c,e)),u&&(o=t.apply(r,i)),o}},n.prototype.dedupe=function(t,e,n){var i;return i=0,function(){var r;return r=this,new Date-i>e?(t.apply(r,arguments),i=new Date):null!=n?n.apply(r,arguments):void 0}},n.prototype.transform=function(t,e){var n;if(n=this.has("transform"))switch(t){case"left":return[n,"translateX("+e+")"];case"top":return[n,"translateY("+e+")"]}else switch(t){case"left":return["left",e];case"top":return["top",e]}},n.prototype.listen=function(t,e,n){var i,r,o,s,a;for(r=["webkit","moz","MS","o",""],a=[],i=o=0,s=r.length;0<=s?o<=s:o>=s;i=0<=s?++o:--o)r[i]||(e=e.toLowerCase()),"function"==typeof t.addEventListener?a.push(t.addEventListener(r[i]+e,n,!1)):a.push(void 0);return a},n}(e))}),define("UI.Middle",["$","Model","View","UI.Browser"],function($,e,n,i){var r,o;return r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={height:void 0,outer:void 0},n.prototype.initialize=function(){return new o({model:this})},n}(e),o=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return i.on("resize",i.debounce(this.resize,200),this),this.model.on("change:height change:outer",this.position,this),this.model.on("create",this.create,this)},n.prototype.create=function(t){return this.$el=t,this.parent=this.$el.parent(),this.resize()},n.prototype.resize=function(){var t,e;return t=this.$el.outerHeight(),e=this.parent.outerHeight(),this.model.set({height:t,outer:e})},n.prototype.position=function(){var t,e;return t=(this.model.get("outer")-this.model.get("height"))/2,e=i.transform("top",parseInt(t)+"px"),this.$el.css(e[0],e[1])},n}(n),r}),define("UI.Toggle",["$","Model","View","Collection","UI.Cookie"],function($,e,n,i,r){var o,s,a,u;return u=0,o=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={active:!1},n.prototype.initialize=function(){return new a({model:this})},n}(e),a=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.model.on("change:active",this.active,this),this.model.on("create",this.create,this),this.model.on("showButton",this.show,this),this.model.on("hideButton",this.hide,this)},n.prototype.create=function(t){return this.$el=t,this.model.set({value:this.$el.data("value")}),this.$el.find(".toggle").length?this.delegateEvents({"click .toggle":this.events.click}):this.delegateEvents(),this.active(this.model,this.model.get("active"))},n.prototype.active=function(t,e){return e?(this.$el.addClass("active"),this.$el.parent().addClass("active-"+this.model.get("i"))):(this.$el.removeClass("active"),this.$el.parent().removeClass("active-"+this.model.get("i")))},n.prototype.show=function(){return this.$el.parents(".content").find("button").removeClass("hidden")},n.prototype.hide=function(){return this.$el.parents(".content").find("button").addClass("hidden")},n.prototype.events={click:function(t){return t.preventDefault(),this.model.set({active:!0})}},n}(n),s=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=o,n.prototype.initialize=function(){return this.on("add",function(){return this.each(function(t,e){return t.set({i:e})})}),this.on("change:active",function(t){return function(){return t.where({active:!0}).length>0?t.first().trigger("showButton"):t.first().trigger("hideButton")}}(this))},n.prototype.exclusive=function(){return this.on("change:active",function(t){return function(e){if(e.get("active")===!0)return t.each(function(t){if(e.cid!==t.cid)return t.set({active:!1})})}}(this))},n.prototype.active=function(){var t;if(t=this.findWhere({active:!0}),null!=t)return t.get("value")},n}(i),o.Collection=s,o}),null==Date.now&&(Date.now=function(){return(new Date).getTime()}),define("UI.Animator",function(){var t;return t=function(e,n,i,r,o,s){var a,u,c,d,h,l,p,f,g,v,m,y,w,b;return null==i&&(i=0),d=t.easing[r]||t.easing.swing,y=e,c=n-e,u=e,m=Date.now(),f=m,g=!0,a=void 0,h=Date.now(),p=function(){if(!g)return g=!0,cancelAnimationFrame(a),f=Date.now()},b=function(){return p()},v=function(){if(g)return g=!1,m+=Date.now()-f,a=requestAnimationFrame(w)},l=function(){return!1},w=function(){var t,r;return t=Date.now()-m,r=1-(i-t)/i,t<i&&!g?(l()||(u=d(r,t,e,c,i),o&&o(u),h=Date.now()),a=requestAnimationFrame(w)):(u=d(r,i,e,c,i),o&&o(n),s&&s())},v(),{resume:v,pause:p,stop:b}},t.easing={linear:function(t,e,n,i,r){return n+t*i},swing:function(t,e,n,i,r){return n+(.5-Math.cos(t*Math.PI)/2)*i},easeInQuad:function(t,e,n,i,r){return i*(e/=r)*e+n},easeOutQuad:function(t,e,n,i,r){return-i*(e/=r)*(e-2)+n},easeInOutQuad:function(t,e,n,i,r){return(e/=r/2)<1?i/2*e*e+n:-i/2*(--e*(e-2)-1)+n},easeInCubic:function(t,e,n,i,r){return i*(e/=r)*e*e+n},easeOutCubic:function(t,e,n,i,r){return i*((e=e/r-1)*e*e+1)+n},easeInOutCubic:function(t,e,n,i,r){return(e/=r/2)<1?i/2*e*e*e+n:i/2*((e-=2)*e*e+2)+n},easeInQuart:function(t,e,n,i,r){return i*(e/=r)*e*e*e+n},easeOutQuart:function(t,e,n,i,r){return-i*((e=e/r-1)*e*e*e-1)+n},easeInOutQuart:function(t,e,n,i,r){return(e/=r/2)<1?i/2*e*e*e*e+n:-i/2*((e-=2)*e*e*e-2)+n},easeInQuint:function(t,e,n,i,r){return i*(e/=r)*e*e*e*e+n},easeOutQuint:function(t,e,n,i,r){return i*((e=e/r-1)*e*e*e*e+1)+n},easeInOutQuint:function(t,e,n,i,r){return(e/=r/2)<1?i/2*e*e*e*e*e+n:i/2*((e-=2)*e*e*e*e+2)+n},easeInSine:function(t,e,n,i,r){return-i*Math.cos(e/r*(Math.PI/2))+i+n},easeOutSine:function(t,e,n,i,r){return i*Math.sin(e/r*(Math.PI/2))+n},easeInOutSine:function(t,e,n,i,r){return-i/2*(Math.cos(Math.PI*e/r)-1)+n},easeInExpo:function(t,e,n,i,r){var o;return null!=(o=0===e)?o:{b:i*Math.pow(2,10*(e/r-1))+n}},easeOutExpo:function(t,e,n,i,r){var o;return null!=(o=e===r)?o:n+{c:i*(-Math.pow(2,-10*e/r)+1)+n}},easeInOutExpo:function(t,e,n,i,r){return 0===e?n:e===r?n+i:(e/=r/2)<1?i/2*Math.pow(2,10*(e-1))+n:i/2*(-Math.pow(2,-10*--e)+2)+n},easeInCirc:function(t,e,n,i,r){return-i*(Math.sqrt(1-(e/=r)*e)-1)+n},easeOutCirc:function(t,e,n,i,r){return i*Math.sqrt(1-(e=e/r-1)*e)+n},easeInOutCirc:function(t,e,n,i,r){return(e/=r/2)<1?-i/2*(Math.sqrt(1-e*e)-1)+n:i/2*(Math.sqrt(1-(e-=2)*e)+1)+n},easeInElastic:function(t,e,n,i,r){var o,s,a;return a=1.70158,s=0,o=i,0===e?n:1===(e/=r)?n+i:(s||(s=.3*r),o<Math.abs(i)?(o=i,a=s/4):a=s/(2*Math.PI)*Math.asin(i/o),-(o*Math.pow(2,10*(e-=1))*Math.sin((e*r-a)*(2*Math.PI)/s))+n)},easeOutElastic:function(t,e,n,i,r){var o,s,a;return a=1.70158,s=0,o=i,0===e?n:1===(e/=r)?n+i:(s||(s=.3*r),o<Math.abs(i)?(o=i,a=s/4):a=s/(2*Math.PI)*Math.asin(i/o),o*Math.pow(2,-10*e)*Math.sin((e*r-a)*(2*Math.PI)/s)+i+n)},easeInOutElastic:function(t,e,n,i,r){var o,s,a;return a=1.70158,s=0,o=i,0===e?n:2===(e/=r/2)?n+i:(s||(s=r*(.3*1.5)),o<Math.abs(i)?(o=i,a=s/4):a=s/(2*Math.PI)*Math.asin(i/o),e<1?-.5*(o*Math.pow(2,10*(e-=1))*Math.sin((e*r-a)*(2*Math.PI)/s))+n:o*Math.pow(2,-10*(e-=1))*Math.sin((e*r-a)*(2*Math.PI)/s)*.5+i+n)},easeInBack:function(t,e,n,i,r,o){return null==o&&(o=1.70158),i*(e/=r)*e*((o+1)*e-o)+n},easeOutBack:function(t,e,n,i,r,o){return null==o&&(o=1.70158),i*((e=e/r-1)*e*((o+1)*e+o)+1)+n},easeInOutBack:function(t,e,n,i,r,o){return null==o&&(o=1.70158),(e/=r/2)<1?i/2*(e*e*(((o*=1.525)+1)*e-o))+n:i/2*((e-=2)*e*(((o*=1.525)+1)*e+o)+2)+n},easeInBounce:function(e,n,i,r,o){return r-t.easing.easeOutBounce(e,o-n,0,r,o)+i},easeOutBounce:function(t,e,n,i,r){return(e/=r)<1/2.75?i*(7.5625*e*e)+n:e<2/2.75?i*(7.5625*(e-=1.5/2.75)*e+.75)+n:e<2.5/2.75?i*(7.5625*(e-=2.25/2.75)*e+.9375)+n:i*(7.5625*(e-=2.625/2.75)*e+.984375)+n},easeInOutBounce:function(e,n,i,r,o){return n<o/2?.5*t.easing.easeInBounce(e,2*n,0,r,o)+i:.5*t.easing.easeOutBounce(e,2*n-o,0,r,o)+.5*r+i}},t}),define("UI.Cookie",["$","Model","View","Collection","UI.Browser"],function($,e,n,i,r){var o,s;return o=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={isNew:!0,name:void 0,value:void 0,type:void 0},n.prototype.initialize=function(){return this.clean()},n.prototype.clean=function(){var t;return t=this.get("value"),"undefined"===t?this.collection.remove(this.set({value:void 0})):"true"===t||"false"===t?this.set({type:"boolean",value:"true"===this.get("value")}):isNaN(t)?void 0:this.set({type:"number",value:+t})},n}(e),new(s=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=o,n.prototype.initialize=function(){var t,e,n,i,o,s,a;if(window.localStorage){if(e=localStorage.getItem("UIdate"),e&&(new Date).toDateString()!==new Date(e).toDateString()&&(localStorage.removeItem("UI"),localStorage.removeItem("UIdate")),t=localStorage.getItem("UI"))for(a=t.split(";"),s=0,o=a.length;s<o;s++)i=a[s],n=i.split(":"),this.add({name:n[0],value:n[1]});return this.on("add change remove",r.debounce(this.save,600))}},n.prototype.select=function(t){return this.findWhere({name:t})},n.prototype.bind=function(t,e,n){var i,r;return i=this.select(n+e),i?(r={},r[e]=i.get("value"),t.set(r)):i=this.add({name:n+e,value:t.get(e)}).last(),t.on("change:"+e,function(){return i.set({value:t.get(e)})})},n.prototype.sync=function(t,e,n){var i,r,o,s;for(e=$.trim(e).replace(/\s+/," ").split(" "),s=[],o=0,i=e.length;o<i;o++)r=e[o],s.push(this.bind(t,r,n));return s},n.prototype.save=function(){var t,e;return e="",t=this.length-1,this.each(function(n,i){var r;return r=i!==t?";":"",e+=n.get("name")+":"+n.get("value")+r}),localStorage.setItem("UI",e),localStorage.setItem("UIdate",(new Date).toString())},n}(i))}),define("UI.Modal",["Model"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={state:"hidden",duration:600},n.prototype.initialize=function(){return this.timeouts=[],this.clear().on("show",this.show).on("hide",this.hide)},n.prototype.clear=function(){var t,e,n,i;for(n=this.timeouts,e=0,t=n.length;e<t;e++)i=n[e],clearTimeout(i);return this.timeouts=[],this},n.prototype.show=function(){return"show"===this.get("state")||"shown"===this.get("state")?this:(this.clear().set({state:"show"}),this.timeouts.push(setTimeout(function(t){return function(){return t.set({state:"shown"})}}(this),this.get("duration"))))},n.prototype.hide=function(){if("hide"!==this.get("state")&&"hidden"!==this.get("state"))return this.clear().set({state:"hide"}),this.timeouts.push(setTimeout(function(t){return function(){return t.set({state:"hidden"})}}(this),this.get("duration")))},n}(e)}),define("UI.Events.Drag",["$"],function($){var t,e,n;return e=/(Android)/g.test(navigator.userAgent),n="ontouchstart"in window||"onmsgesturechange"in window,t=function(t){var i,r,o,s,a,u,c,d,h,l,p,f,g,v,m,y,w,b,_,E,B,C,k,M,I,T,S,z;return f=t.max||6,g=null!=t.min?t.min:15,w=null==t.preventable||t.preventable,t.$el||t.suffix?(l=$(document),d=t.$el,k=t.suffix,E=t.selector,i={},a=function(t,e,n){return i[t]=i[t]||[],i[t].push({callback:e,once:n})},_=function(){return i={}},I=function(t,e,n,r,o){var s,a,u,c,d,h,l,p,f,g;if(_=[],i[t]){for(p=i[t],a=h=0,c=p.length;h<c;a=++h)s=p[a],s.callback(e,n,r,o),s.once&&_.push(a);for(f=[],u=g=0,d=_.length;g<d;u=++g)l=_[u],f.push(i[t].splice(l-u,1));return f}},y=function(t,e){return a(t,e,!0)},o=void 0,s=void 0,b=[],S=void 0,B=void 0,M=function(t){return b.length===f&&b.splice(0,1),b.push({pageX:t.pageX,pageY:t.pageY,time:new Date})},z=function(t){var e,n;return n=b[b.length-1],e=b[0],(n[t]-e[t])/(n.time-e.time)},h=function(t){return b[b.length-1][t]-b[0][t]},r=function(t){if(o=t.pageX,s=t.pageY,b=[],S=void 0,B=new Date,M(t),I("start",t.pageX,t.pageY),n||l.on("mousemove"+k,function(t){if(M(t),p())return w&&t.preventDefault(),C(t)}),!n)return l.on("mouseup"+k,function(t){return w&&t.preventDefault(),c(t)})},C=function(t){return I("move",t.pageX-o,t.pageY-s)},c=function(t){var e,i,r,o,s;if(n||l.off("mousemove"+k+" mouseup"+k),o=p()?z("pageX"):0,s=p()?z("pageY"):0,e=Math.abs(h("pageX")),i=Math.abs(h("pageY")),r=new Date-B,e>=g||i>=g||r>500)return I("end",o,s,r,t)},p="y"===t.prevent?function(){if("boolean"==typeof S)return S;if(b.length>1&&e)S=Math.abs(h("pageX"))/Math.abs(h("pageY"))>.5;else{if(b.length<3)return!1;S=Math.abs(h("pageX"))/Math.abs(h("pageY"))>1}return S}:"x"===t.prevent?function(){return"boolean"==typeof S?S:!(b.length<3)&&(S=Math.abs(h("pageY"))/Math.abs(h("pageX"))>1)}:function(){return!0},d[0]&&d[0].addEventListener&&(d.on("touchstart"+k,E,function(t){return t=t.originalEvent,r(t.targetTouches[0])}),d.on("touchmove"+k,E,function(t){if(t=t.originalEvent,M(t.targetTouches[0]),p())return w&&t.preventDefault(),C(t.targetTouches[0])}),d.on("touchend"+k,E,function(t){return c(t)})),m=function(){var e;return e=null!=E?d.find(E):d,"y"===t.prevent?e.css("-ms-touch-action","pan-y"):"x"===t.prevent?e.css("-ms-touch-action","pan-x"):e.css("-ms-touch-action","none"),e},navigator.pointerEnabled||navigator.msPointerEnabled?(u=m(),v=function(t){if(M(t),p())return w&&t.preventDefault(),C(t)},T=function(t){return c(t),window.removeEventListener("MSPointerMove",v),window.removeEventListener("MSPointerUp",T)},u.each(function(){var t;return t=$(this)[0],t.addEventListener("MSPointerDown",function(t){return r(t),window.addEventListener("MSPointerMove",v),window.addEventListener("MSPointerUp",T)})})):n||d.on("mousedown"+k,E,function(t){if(2!==t.button)return w&&t.preventDefault(),r(t)}),{on:a,off:_,trigger:I,once:y}):{on:function(){},trigger:function(){},off:function(){}}}}),define("UI.Events",["UI.Events.Drag","UI.Browser","$"],function(t,e,$){var n,i,r;return r=0,i=void 0,n={Drag:t,touch:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n})),this._drag.on("start",i)},touching:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n})),this._drag.on("move",i)},touched:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n})),this._drag.on("end",i),delete this._drag},swipe:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n,prevent:"y"})),this._drag.on("start",i)},swiping:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n,prevent:"y"})),this._drag.on("move",i)},swiped:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n,prevent:"y"})),this._drag.on("end",i),delete this._drag},pan:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n,prevent:"x"})),this._drag.on("start",i)},panning:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n,prevent:"x"})),this._drag.on("move",i)},panned:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n,prevent:"x"})),this._drag.on("end",i),delete this._drag},tap:function(t,e,n){return this.$el.on("mousedown"+t,e,function(i){return function(r){var o,s,a;if(s=r.pageX,a=r.pageY,1===r.which)return o=setTimeout(function(){return i.$el.off("mouseup"+t)},500),i.$el.one("mouseup"+t,e,function(t){var e,i,r,o;if(r=t.pageX,o=t.pageY,e=Math.abs(r-s),i=Math.abs(o-a),e<15&&i<15)return n(t)})}}(this))},hold:function(t,e,n){return this.$el.on("mousedown"+t,e,function(){var t;return t=setTimeout(function(){return n()},1e3),$(document).one("mouseup",function(){return clearTimeout(t)})})}},(e.is.IOS()||e.is.android())&&(n.click=function(n,i,r){var o;return o=function(o){return function(){var s;switch(o.$el.off("click"+n+" mousedown"+n+" touchstart"+n+" touchmove"+n+" touchend"+n,i),s=e.get("input")||"touch"){case"mouse":return o.$el.on("click"+n,i,r);case"touch":return o._drag=t({$el:o.$el,suffix:n,selector:i,min:0,preventable:!1,ms:!1}),o._drag.on("end",function(t,e,n,i){if(n<200&&isNaN(t)&&isNaN(e))return r(i)})}}}(this),o(),e.on("change:input",o),this.unlisten.push(function(){return e.off("change:input",o)})}),n}),define("UI",["UI.Browser","UI.Middle","UI.Toggle","UI.Animator","UI.Cookie","UI.Modal","UI.Events"],function(t,e,n,i,r,o,s){return window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,15)},window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return clearTimeout(t)},{Browser:t,Middle:e,Toggle:n,Animate:i,Cookie:r,Modal:o,Events:s}}),define("BE.Models.Logic",["Model","Data"],function(e,n){var i,r,o,s;return s=n.logic,r=n.foundation,i=n.alternate,o=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.defaults={track:void 0,coverage:void 0,finish:void 0,concern:void 0,skintype:void 0,shade:void 0,undertone:void 0,family:void 0,brush:void 0,products:void 0,foundation:void 0,showing:0},o.prototype.initialize=function(){return this.set({brush:[],products:[],foundation:[]}),this.on("change:coverage change:finish change:concern change:skintype",this.match),this.on("change:shade change:undertone change:family",this.shade),this.on("change:family",this.shades),this.on("change:brush change:products change:foundation",this.ids),this.on("change:family change:foundation",this.brush)},o.prototype.clean=function(t){if(null!=t)return t.toLowerCase().replace(/[^a-z]/g,"")},o.prototype.match=function(){var t,e,n,i;return e=this.clean(this.get("coverage")),n=this.clean(this.get("finish")),t=this.clean(this.get("concern")),i=this.clean(this.get("skintype")),null!=e&&null!=n&&null!=i&&null!=t&&null!=s[e]&&s[e][n]&&s[e][n][t]&&s[e][n][t][i]?this.set(s[e][n][t][i]):this.set({brush:[],products:[],family:[]})},o.prototype.shade=function(){var t,e,n,o,s,a;return n=this.get("family"),s=this.clean(this.get("shade")),a=this.get("undertone"),o=[],null!=n&&null!=s&&null!=a&&(t=this.clean(n[0]),r[t]&&r[t][s]&&r[t][s][a]&&(o.push(r[t][s][a]),e=this.clean(n[1]),i[o[0]]&&i[o[0]][e]&&o.push(i[o[0]][e]))),this.set({foundation:o})},o.prototype.shades=function(){var t,e,n,i,o;e=this.get("family")[0],o=r[this.clean(e)],t=[];for(n in o)i=o[n],t.push({id:n,options:i});return this.set({shades:t})},o.prototype.brush=function(){var t,e,i;if(e=this.get("family")[0],i=this.get("foundation"),t=this.get("brush"),e&&i&&i.length&&t&&(!t.length||this.get("usingDefault"))&&n.defaults[this.clean(e)])return this.set(_.extend({usingDefault:!0},n.defaults[this.clean(e)]))},o.prototype.ids=function(){var t,e,n,i,r,o,s,a,u,c,d,h,l;for(n=[],u=this.get("foundation"),a=0,i=u.length;a<i;a++)e=u[a],n.push({type:ShadeFinder.text.productType.foundation,id:e});for(c=this.get("brush"),h=0,r=c.length;h<r;h++)t=c[h],n.push({type:ShadeFinder.text.productType.brush,id:t});for(d=this.get("products"),l=0,o=d.length;l<o;l++)s=d[l],n.push({type:ShadeFinder.text.productType.product,id:s});return this.set({ids:n})},o}(e)}),define("BE.Models.Page",["$","Model"],function($,e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.states=[],n.prototype.defaults={state:0,nav:void 0,page:void 0,track:void 0,transitioning:!1,menu:!1,animation:void 0},n.prototype.initialize=function(){var t,e,n,i;for(this.get("state")<100&&this.set({state:0}),this.stateIndex=[],n=this.states,e=0,t=n.length;e<t;e++)i=n[e],this.stateIndex.push(i.id);return this.on("change:state",this.transition),this.on("change:animation",function(){return this.trigger(this.get("animation"))})},n.prototype.transition=function(){var t;return t=_.findWhere(this.states,{id:this.get("state")}),this.set({nav:t.nav,page:Math.floor(t.id/100)}),clearTimeout(this.timeout),t.duration>0?this.timeout=setTimeout(function(e){return function(){if(t.continue)return e.navigate(t.continue)}}(this),t.duration):t.continue?this.navigate(t.continue):void 0},n.prototype.navigate=function(t){var e;return t!==!0&&null!=t||(e=_.indexOf(this.stateIndex,this.get("state")),t=this.stateIndex[e+1]),this.set({state:t})},n.prototype.back=function(){var t,e,n;return e=this.get("page"),t=7===e?1:1===this.get("track")&&9===e?6:e-1,n=_.find(this.states,function(e){return Math.floor(e.id/100)===t&&e.continue===!1}),this.navigate(n.id)},n}(e)}),define("BE.Models.Intro",["UI","Model"],function(e,n){var i,r,o;return r=e.Browser,i=e.Animate,o=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={position:0,page:void 0,height:void 0,visible:!0},n.prototype.initialize=function(){return r.on("resize",this.resize,this),this.on("change:position",this.visible,this),$(window).on("mousewheel DOMMouseScroll",function(t){return function(e){var n,i;if(0===t.get("page")||1===t.get("page"))return e.preventDefault(),t.stop(),null!=e.originalEvent.wheelDelta?n=e.originalEvent.wheelDelta/2:null!=e.originalEvent.deltaY?n=e.originalEvent.deltaY:null!=e.originalEvent.detail&&(n=8*-e.originalEvent.detail),i=t.get("position")+n/t.get("height"),i>0?i=0:i<-1&&(i=-1),t.set({position:i})}}(this)),this.on("change:page",this.page)},n.prototype.resize=function(t){return this.set({height:t.height})},n.prototype.visible=function(){var t;return t=this.get("position"),t<-.25?this.set({visible:!1}):this.set({visible:!0})},n.prototype.stop=function(){if(null!=this.animation)return this.animation.stop()},n.prototype.animateOut=function(){var t;return this.stop(),t=this.get("position"),this.animation=i(t,-1,800*(t+1),void 0,function(t){return function(e){return t.set({position:e})}}(this))},n.prototype.page=function(){if(this.get("page")>1&&this.get("position")!==-1)return this.animateOut()},n}(n)}),define("BE.Models.Resolve",["$","Model"],function($,e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={result:{},foundation:[],brushes:[],products:[],family:[],hasProducts:!1,productsVisible:!0,hasSecondary:!1},n.prototype.initialize=function(){return this.on("refresh",this.refresh),this.on("change:products",this.products),this.on("change:brushes change:foundation",this.matches),this.on("change:brushes change:foundation",this.both),this.on("change:family",this.family)},n.prototype.refresh=function(t){var e,n,i,r,o,s,a,u,c,d,h,l,p,f,g,v;for(f=this.get("result"),n=[],h=f.foundation,i=d=0,o=h.length;d<o;i=++d)r=h[i],u=t.findWhere({id:r}),u&&n.push(u);for(e=[],l=f.brush,i=g=0,s=l.length;g<s;i=++g)r=l[i],u=t.findWhere({id:r}),u&&e.push(u);for(c=[],p=f.products,i=v=0,a=p.length;v<a;i=++v)r=p[i],u=t.findWhere({id:r}),u&&c.push(u);return this.set({foundation:n,brushes:e,products:c}),this.trigger("render")},n.prototype.matches=function(){var t,e;return t=this.get("brushes"),e=this.get("foundation"),t.length+e.length===4?this.set({hasSecondary:!0}):this.set({hasSecondary:!1})},n.prototype.both=function(){var t,e,n,i,r,o,s;for(n=this.get("brushes"),i=this.get("foundation"),t=[],r=s=0,o=n.length;s<o;r=++s)e=n[r],e.get("isAvailable")&&i[r]&&i[r].get("isAvailable")?t.push(!0):t.push(!1);return this.set({both:t})},n.prototype.products=function(){var t;return t=this.get("products"),t.length?this.set({hasProducts:!0}):this.set({hasProducts:!1})},n.prototype.family=function(){var t,e,n,i,r,o;for(e=[],r=this.get("family"),o=[],i=0,n=r.length;i<n;i++)t=r[i],t?o.push(e.push(ShadeFinder.text.family[t.toLowerCase()])):o.push(void 0);return o},n}(e)}),define("BE.Models.Shade",["Model"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={id:void 0,active:void 0,value:void 0,undertone:void 0,family:void 0},n.prototype.initialize=function(){return this.set({value:this.id})},n}(e)}),define("BE.Models.Product",["Model"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={id:void 0,type:void 0,name:void 0,shortDescription:void 0,longDescription:void 0,pricing:void 0,availability:void 0,subtitle:void 0,imageUrl:void 0,thumbnailUrl:void 0,url:void 0,isAvailable:void 0,video:void 0,added:!1,master:!1,color:void 0,foundation:void 0,price:void 0,addedToSidebar:!1},n.prototype.initialize=function(){return this.refresh()},n.prototype.refresh=function(){var t,e,n,i,r,o;return n=this.get("name"),n=n?n.split(" - ")[0]:"",r=/broad spectrum spf (\d{0,3})/gi,n.match(r)?(i=n.match(r)[0],t=n.replace(r,""),e='<span class="heading">'+n.replace(r,"")+"</span>",o='<span class="sub">'+i+"</span> ",n=e+o,this.set({name:n,foundation:t})):(this.set({name:'<span class="heading">'+n+"</span>"}),this.set({foundation:n}))},n.prototype.addToCart=function(t){if(!this.get("added"))return this.set({added:!0}).trigger("cart",this.id,t)},n}(e)}),define("BE.Models.VideoModal",["UI"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={state:"hidden",duration:600,video:void 0,baseUrl:ShadeFinder.urls.video},n}(e.Modal)}),define("BE.Models.Cart",["Model"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url=ShadeFinder.urls.cart,n.prototype.addUrl=ShadeFinder.urls.addToCart,n.prototype.defaults={products:[],subtotal:0,numItems:0},n.prototype.initialize=function(){return this.fetch()},n.prototype.has=function(t){var e,n,i,r,o;for(e=!1,t=ShadeFinder.prefix+t,o=this.get("products"),r=0,n=o.length;r<n;r++)i=o[r],i.id===t&&(e=!0);return e},n.prototype.add=function(t){var e,n;return e=ShadeFinder.prefix+t.join("_"+ShadeFinder.prefix),n=$.ajax({type:"POST",url:this.addUrl+e,data:{Quantity:1,uuid:"",cartAction:"update",pid:e}}),n.done(function(t){return function(n){return t.trigger("added",e),t.fetch({success:function(){return t.trigger("change:products",t,t.get("products"))}})}}(this)),n.fail(function(t){return function(){return t.trigger("failed",e)}}(this))},n}(e)}),define("BE.Models.MobileFinish",["Model","UI"],function(e,n){var i,r;return i=n.Animate,r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={state:1,position:1,tutoring:!1},n.prototype.initialize=function(){return this.on("change:state",this.animate),this.on("tutorial",this.tutorial),this.tutored=sessionStorage.getItem("tutored")},n.prototype.stop=function(){if(null!=this.animation)return this.animation.stop()},n.prototype.animate=function(){var t,e;return this.stop(),e=this.previous("state"),t=this.get("state"),this.animation=i(e,t,400,"swing",function(t){return function(e){return t.set({position:e})}}(this))},n.prototype.prev=function(){var t;if(t=this.get("state"),t>0&&this.tutored)return this.set({state:t-1})},n.prototype.next=function(){var t;if(t=this.get("state"),t<2&&this.tutored)return this.set({state:t+1})},n.prototype.tutor=function(){return i(1,1.5,800,"swing",function(t){return function(e){return t.set({position:e})}}(this),function(t){return function(){return i(1.5,.5,1200,"swing",function(e){return t.set({position:e})},function(){return i(.5,1,800,"swing",function(e){return t.set({position:e})},function(){return t.set({tutoring:!1})})})}}(this))},n.prototype.tutorial=function(t){if(!this.tutored)return this.tutored=!0,sessionStorage.setItem("tutored",!0),setTimeout(function(t){return function(){return t.set({tutoring:!0}),setTimeout(function(){return t.tutor()},800)}}(this),t||1200)},n}(e)}),define("BE.Views.Header",["View"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.model.on("change:nav",this.nav,this);
},n.prototype.create=function(t){return this.$el=t,this.delegateEvents()},n.prototype.nav=function(){var t,e;return e=this.model.previous("nav"),null==e&&(e="start"),t=this.model.get("nav"),this.$el.attr("class","to-"+t+" from-"+e+" visible")},n.prototype.events={"click .mobile-toggle":function(t){return t.preventDefault(),this.model.set({menu:!this.model.get("menu")})},"click .navigate":function(t){var e;return t.preventDefault(),e=$(t.currentTarget),this.model.navigate(e.data("to"),e.data("direction"))},"click .back":function(t){return t.preventDefault(),this.model.back()},"click .close":function(t){return t.preventDefault(),this.model.trigger("close")},"click .reset":function(t){return $(".current").removeClass("current"),$(t.target).addClass("current"),this.model.trigger("reset")}},n}(e)}),define("BE.Views.Progress",["View","UI.Browser"],function(e,i){var r;return r=function(e){function r(){return this.hoverOff=n(this.hoverOff,this),this.hoverOn=n(this.hoverOn,this),this.progressClick=n(this.progressClick,this),this.click=n(this.click,this),this.sidebarClick=n(this.sidebarClick,this),this.animateIn=n(this.animateIn,this),r.__super__.constructor.apply(this,arguments)}return t(r,e),r.prototype.initialize=function(){return this.model.on("create",this.create,this),i.is.touch()||$(".progress").bind("mouseenter",this.hoverOn),$(".progress").on("click",this.progressClick),$(".dot").on("click",this.click),$(".side-menu").bind("mouseleave",this.hoverOff),$(".sidebar-label").on("click",this.sidebarClick)},r.prototype.create=function(t){return this.$el=t,this.delegateEvents()},r.prototype.show=function(){return this.$el.addClass("show")},r.prototype.hide=function(){return this.$el.removeClass("show")},r.prototype.animateIn=function(){return setTimeout(function(){$(".sidebar").addClass("open")},1e3),this.initialSidebarHide=setTimeout(function(){$(".sidebar").removeClass("open")},2500)},r.prototype.selections=function(t){var e,n,i,r,o;for(this.selections=t,i=this.selections,r=[],n=0,e=i.length;n<e;n++)o=i[n],r.push(this.model.on("change:"+o,this.selection,this));return r},r.prototype.pages=function(t){return this.pages=t,this.model.on("change:page",this.page,this)},r.prototype.selection=function(){return this.$el.each(function(t){return function(e,n){var i,r,o,s,a,u,c,d,h,l,p,f;for(n=$(n),n=n.parent(),r=n.find(".progress-0 .dot"),o=n.find(".progress-1 .dot"),i=2===t.track?o:r,u=n.find(".sidebar-0 .sidebar-label"),c=n.find(".sidebar-1 .sidebar-label"),a=2===t.track?c:u,l=t.selections,p=[],s=h=0,d=l.length;h<d;s=++h)f=l[s],null!=t.model.get(f)&&t.model.get(f).length?(i.eq(s+1).hasClass("terminal")&&(i.eq(s+1).addClass("current"),i.eq(s).removeClass("current"),a.eq(s+1).addClass("current"),a.eq(s).removeClass("current")),i.eq(s).addClass("active"),i.eq(s+1).removeClass("disabled"),a.eq(s).addClass("active"),p.push(a.eq(s+1).removeClass("disabled"))):(i.eq(s).removeClass("active"),i.eq(s+1).addClass("disabled"),a.eq(s).removeClass("active"),p.push(a.eq(s+1).addClass("disabled")));return p}}(this))},r.prototype.page=function(){return this.$el.each(function(t){return function(e,n){var i,r,o,s,a,u,c,d,h,l,p,f,g;for(n=$(n),n=n.parent(),l=t.model.get("page"),r=n.find(".progress-0 .dot"),o=n.find(".progress-1 .dot"),i=r,u=n.find(".sidebar-0 .sidebar-label"),c=n.find(".sidebar-1 .sidebar-label"),a=u,f=t.pages,g=[],s=p=0,d=f.length;p<d;s=++p)h=f[s],2===t.track?(i=o,a=c):(i=r,a=u),h<l&&(i.eq(s).addClass("passed"),a.eq(s).addClass("passed")),h===l?(i.eq(s-1).addClass("current"),g.push(a.eq(s-1).addClass("current"))):(i.eq(s-1).removeClass("current"),g.push(a.eq(s-1).removeClass("current")));return g}}(this))},r.prototype.navigate=function(t){var e;if(!t.hasClass("disabled")&&(e=t.data("to"),Math.floor(e/100)-this.model.get("page")===1||901===e&&6===this.model.get("page")?this.model.trigger("navigate"):this.model.trigger("navigate",t.data("to")),t.parents().find(".mobile-nav")))return $(".mobile-toggle").click()},r.prototype.sidebarClick=function(t){var e,n,i;if(this.$el.hasClass("show"))return n=$(t.target).attr("class").toString().split(" "),i=$.grep(n,function(t,e){return t.indexOf("dot")>=0}),e=$(".progress-"+(this.track-1)+" ."+i[0]),e.bind("click touchstart",this.click),e.click()},r.prototype.click=function(t){var e,n,i;if(n=$(t.target),t.preventDefault(),n.parent().hasClass("show")&&!n.hasClass("current"))return n.hasClass("disabled")||n.hasClass("current")||($(".current").removeClass("current"),n.toggleClass("current")),e=$(t.target),i=e.parents(".mobile-nav"),i.length?($(".menu-open").addClass("menu-closed").removeClass("menu-open"),i.removeClass("visible"),setTimeout(function(t){return function(){return t.navigate(e),i.addClass("hidden")}}(this),400)):this.navigate(e)},r.prototype.progressClick=function(t){return t.stopImmediatePropagation(),$(t.currentTarget).find(".toggle-open").hasClass("active")||$(t.target).hasClass("toggle-open")?this.hoverOn(t):this.hoverOff(t)},r.prototype.hoverOn=function(t){return t.stopImmediatePropagation(),$(".toggle-open").removeClass("active"),$(".toggle-close").addClass("active"),$(t.currentTarget).hasClass("progress-0")?$(".sidebar-0").addClass("open"):$(".sidebar-1").addClass("open")},r.prototype.hoverOff=function(t){return this.initialSidebarHide&&clearTimeout(this.initialSidebarHide),t.stopImmediatePropagation(),$(".toggle-open").addClass("active"),$(".toggle-close").removeClass("active"),$(".open").removeClass("open")},r}(e)}),define("BE.Views.Page",["$","UI","View"],function($,e,n){var i,r;return i=e.Browser,r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.model.on("create",this.create,this),this.model.on("change:state",this.state,this),this.model.on("change:menu",this.menu,this),this.model.on("change:page",this.page,this)},n.prototype.create=function(t){return this.$el=t,this.body=$("body"),this.delegateEvents(this.events),i.listen(this.body[0],"AnimationEnd",function(t){return function(e){return t.model.set({animation:e.animationName})}}(this))},n.prototype.state=function(){var t,e;if(e=this.model.previous("state"),null==e&&(e="start"),t=this.model.get("state"),this.body)return this.body.attr("class","show from-"+e+" to-"+t)},n.prototype.menu=function(){return this.model.get("menu")?$("html").addClass("menu-open").removeClass("menu-closed"):$("html").addClass("menu-closed").removeClass("menu-open")},n.prototype.page=function(){var t,e;return e=this.model.previous("page"),null==e&&(e="start"),t=this.model.get("page"),this.$el.attr("class","from-page-"+e+" to-page-"+t)},n.prototype.events={"click .navigate":function(t){var e;return t.preventDefault(),e=$(t.currentTarget),this.model.navigate(e.data("to"),e.data("direction"))},"click .back":function(t){return t.preventDefault(),this.model.back()},"click .close":function(t){return t.preventDefault(),this.model.trigger("close")},"click .reset":function(){return this.model.trigger("reset")},"click .video":function(t){var e;return e=$(t.currentTarget).data("video"),this.model.trigger("video",e)},"click .print":function(t){return t.preventDefault(),window.print()}},n}(n)}),define("BE.Views.Intro",["UI","View"],function(e,n){var i,r;return i=e.Browser,r=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.initialize=function(){return this.model.on("create",this.create,this),this.model.on("fade",this.fade,this)},i.prototype.create=function(t){return this.$el=t,this.delegateEvents(),this.model.on("change:position",this.position,this)},i.prototype.fade=function(t){return this.$next=t,this.model.on("change:position",this.fading,this)},i.prototype.position=function(){var t,n;return t=this.model.get("position"),n=e.Browser.transform("top",100*t+"%"),this.$el.css(n[0],n[1])},i.prototype.fading=function(){var t;return t=this.model.get("position"),this.$next.css("opacity",-t)},i.prototype.animateOut=function(t){return t.preventDefault(),this.model.animateOut()},i.prototype.events={"click .start":"animateOut"},i}(n)}),define("BE.Views.Match",["View"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.model.on("change:showing",this.showing,this)},n.prototype.create=function(t){return this.$el=t,this.delegateEvents()},n.prototype.showing=function(){var t;return t=this.model.get("showing"),this.$el.removeClass("showing-0 showing-1").addClass("showing-"+t)},n.prototype.events={"click .toggle-match":function(t){var e;return t.preventDefault(),e=0===this.model.get("showing")?1:0,this.model.set({showing:e})}},n}(e)}),define("BE.Views.Resolve",["$","UI","View","BE.Views.Product"],function($,e,n,i){var r,o;return r=e.Browser,o=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype._addBoth=_.template('<div class="price">&nbsp;</div><button class="add-both">'+ShadeFinder.text.addBoth+"</button>"),n.prototype._addedBoth=_.template('<div class="price">&nbsp;</div><button class="disabled" readonly>'+ShadeFinder.text.addBoth+"</button>"),n.prototype.initialize=function(){return r.on("resize",this.resize,this),this.model.on("create",this.create,this),this.model.on("render",this.foundation,this),this.model.on("render",this.brushes,this),this.model.on("render",this.products,this),this.model.on("change:hasProducts change:productsVisible",this.hasProducts,this),this.model.on("change:hasSecondary",this.hasSecondary,this),this.model.on("change:both",this.both,this),this.model.on("change:addedBoth",this.addedBoth,this),this.model.on("reset",this.reset,this)},n.prototype.create=function(t){return this.$el=t,this.delegateEvents()},n.prototype.resize=function(t){var e,n;return n=0,e=this.$el.find(".match"),e.each(function(){var t;if(t=$(this).find(".match-inner").height(),t>n)return n=t}),e.eq(0).css("min-height",n)},n.prototype.foundation=function(){var t,e,n,o,s,a,u;for(a=this.model.get("foundation"),u=[],e=s=0,o=a.length;s<o;e=++s)t=a[e],0===e?n=1:1===e&&(n=0),new i({model:t}).create(this.$el.find(".match").eq(e).find(".foundation")).tease(this.$el.find(".teaser").eq(n),e),u.push(r.resize());return u},n.prototype.brushes=function(){var t,e,n,o,s;for(s=this.model.get("brushes"),e=o=0,n=s.length;o<n;e=++o)t=s[e],new i({model:t}).create(this.$el.find(".match").eq(e).find(".brush"));return r.resize()},n.prototype.products=function(){var t,e,n,o,s;for(s=this.model.get("products"),t=o=0,e=s.length;o<e;t=++o)n=s[t],new i({model:n}).create(this.$el.find(".product-"+t));return r.resize()},n.prototype.hasProducts=function(){var t,e;return t=this.model.get("hasProducts"),e=this.model.get("productsVisible"),t&&e?this.$el.find(".cross-sells").removeClass("hidden"):this.$el.find(".cross-sells").addClass("hidden")},n.prototype.hasSecondary=function(){var t;return t=this.model.get("hasSecondary"),t?this.$el.find(".match.second, .toggle-match").removeClass("hidden"):this.$el.find(".match.second, .toggle-match").addClass("hidden")},n.prototype.both=function(){var t,e,n,i,r,o;for(e=this.model.get("both"),o=[],n=r=0,i=e.length;r<i;n=++r)t=e[n],t?o.push(this.$el.find(".match").eq(n).find(".both").removeClass("hidden")):o.push(this.$el.find(".match").eq(n).find(".both").addClass("hidden"));return o},n.prototype.addedBoth=function(){var t,e,n,i,r,o,s;for(r=this.$el.find(".match"),t=this.model.get("addedBoth"),s=[],e=o=0,i=t.length;o<i;e=++o)n=t[e],n?s.push(r.eq(e).find(".both.button").html(this._addedBoth())):s.push(r.eq(e).find(".both.button").html(this._addBoth()));return s},n.prototype.reset=function(){return this.$el.find(".foundation, .brush, .cross-sell").each(function(){return $(this).html("&nbsp;")})},n.prototype.events={"click .add-both":function(t){var e;return e=$(t.currentTarget).parents(".match"),e.hasClass("first")?this.model.trigger("addBoth",0):e.hasClass("second")?this.model.trigger("addBoth",1):void 0}},n}(n)}),define("BE.Views.Shade",["UI","View","BE.Logic"],function(e,n,i){var r,o;return r=e.Browser,o=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=_.template('<div class="shade soum-test shade-<%= id %> undertones-<%= _.size(options) %>" data-value="<%= id %>" data-category="Shade"><div class="background"><div class="buttons"><% _.each(options, function(option, j) { %><% var cssClass = j.toLowerCase().replace(/\\s/gi, "-"); %><% console.log(j); %><% var y = ShadeFinder.undertones[j]; %><div class="example navigate undertone" data-value="<%= j %>" data-category="<%= family %> Undertone"><div class="image <%= id.toLowerCase() %>-<%= cssClass %>"></div><div class="button-wrap"><% if (y) { %><div class="undertone-button" style="background-color: <%= y.color %>;"><div class="undertone-button-inner"><span class="title"><%= y.title %></span><span class="subtitle"><%= y.description %></span><span class="subtitle"><%= y.undertone %></span></div></div><% } %></div></div><% }); %></div></div><div class="toggle"><h4><%= id %></h4></div></div>'),n.prototype.initialize=function(){return this.model.on("create",this.create,this),this.model.on("destroy",this.destroy,this),this.model.on("change:active",this.active,this),r.on("resize",this.resize,this),this.model.collection.on("render",this.resize,this),this.model.on("change:top",this.top,this),this.model.collection.on("undertoned",this.undertoned,this),this.model.set({family:i.get("family")[0].toUpperCase()})},n.prototype.create=function(t){var e;return t.append(this.template(this.model.attributes)),e=t.find(".shade"),this.$el=e.last(),this.delegateEvents(),this.active(this.model,this.model.get("active")),this.resize(),this.top(),this.model.on("resized",r.debounce(function(t){return function(){return t.resized()}}(this),400))},n.prototype.destroy=function(){return this.undelegateEvents()},n.prototype.resize=function(){return this.model.set({innerHeight:this.$el.find(".buttons").outerHeight(!0),toggleHeight:this.$el.find(".toggle").outerHeight()}),this.model.trigger("resized")},n.prototype.resized=function(){var t;if(t=0,this.$el.find(".undertone-button-inner").each(function(){var e;if(e=$(this).outerHeight(!0),e>t)return t=e}),t>10)return this.$el.find(".undertone-button").height(t)},n.prototype.top=function(){var t;return t=r.transform("top",this.model.get("top")+"px"),this.$el.css(t[0],t[1])},n.prototype.active=function(t,e){return e?(this.$el.addClass("active"),this.$el.parent().addClass("active-"+this.model.id)):(this.$el.removeClass("active"),this.$el.parent().removeClass("active-"+this.model.id))},n.prototype.undertoned=function(t){return this.$el.find(".undertone").removeClass("selected").end().find('[data-value="'+t+'"]').addClass("selected")},n.prototype.events={"click .toggle":function(t){return t.preventDefault(),this.model.set({active:!0})},"click .undertone":function(t){return t.preventDefault(),this.model.set({undertone:$(t.currentTarget).data("value")}),this.model.trigger("undertone",$(t.currentTarget).data("value"))}},n}(n)}),define("BE.Views.Product",["View","BE.Cart"],function(e,n){var i;return i=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.template=_.template('<% if (isAvailable) { %><a class="product-image" target="_blank" href="<%=url %>"><% if (imageUrl) { %><img src="<%= imageUrl %>" /><% } %></a><% } else { %><div class="product-image"><% if (imageUrl) { %><img src="<%= imageUrl %>" /><% } %></div><% } %>'),i.prototype.titleTemplate=_.template('<% if (isAvailable) { %><a class="name" target="_blank" href="<%=url %>"><%= name %><% if (color) { %><span class="color"><%= color %></span><% } %></a><% } else { %><div class="name"><%= name %></div><% } %>'),i.prototype.descriptionTemplate=_.template('<% if (subtitle) { %><div class="subtitle"><%= subtitle %></div><% } %><% if (type === "foundation" && video) { %><a class="video" data-video="<%= video %>">'+ShadeFinder.text.watchVideo+" <%= foundation %> "+ShadeFinder.text.watchVideo2+"</a><% } %>"),i.prototype.buttonTemplate=_.template('<% if (price) { %><div class="price"><%= price %></div><% } %><% if (master) { %><button class="learn-more" href="<%=url %>">'+ShadeFinder.text.learnMore+'</button><% } else if (added) { %><button class="disabled" readonly>'+ShadeFinder.text.addedToBag+'</button><% } else if (isAvailable) { %><button class="add" data-id="<%= id %>">'+ShadeFinder.text.addToBag+'</button><% } else { %><button class="disabled" readonly>'+ShadeFinder.text.notAvailable+"</button><% } %>"),i.prototype.teaser=_.template('<div class="teaser-wrap <% if (thumbnailUrl) print("has-image"); %>"><% if (thumbnailUrl) { %><div class="teaser-image"><img src="<%= thumbnailUrl %>" /></div><% } %><% if (foundation) { %><p class="teaser-message"><span><%= prelude %></span> <%= foundation %></p><% } else { %><p class="teaser-message"><span><%= prelude %></span> '+ShadeFinder.text.notFound.toLowerCase()+"</p><% } %></div>"),i.prototype.sidebarTemplate=_.template('<div class="item just-added"><% if (name) { %><p class="item-name"><%= type %></p><% } %><% if (price) { %><p class="item-price"><%= price %></p><% } %></div>'),i.prototype.initialize=function(){return this.model.on("change:added",this.added,this),this.model.on("destroy",this.destroy,this)},i.prototype.create=function(t){return this.$el=t,this.$el.not(".button").not(".description").not(".title").html(this.template(this.model.attributes)),this.$el.not(".content").not(".description").not(".button").html(this.titleTemplate(this.model.attributes)),this.$el.not(".button").not(".content").not(".title").html(this.descriptionTemplate(this.model.attributes)),this.$el.not(".content").not(".description").not(".title").html(this.buttonTemplate(this.model.attributes)),this.delegateEvents()},i.prototype.tease=function(t,e){var n,i;return i=1===e?ShadeFinder.text.youMightAlso:ShadeFinder.text.returnToOur,n=_.extend({prelude:i},this.model.attributes),t.html(this.teaser(n))},i.prototype.destroy=function(){return this.model.off("create",this.create),this.model.off("change:added",this.added),this.model.off("destroy",this.destroy),this.model.off("tease",this.tease),this.undelegateEvents()},i.prototype.added=function(){var t,e,i,r;if(this.$el.not(".content").not(".description").not(".title").html(this.buttonTemplate(this.model.attributes)),!this.model.get("addedToSidebar")&&!n.has(this.model.id)){for($(".item").removeClass("just-added"),n.set({subtotal:n.get("subtotal")+this.model.get("pricing").sale}),"before"===ShadeFinder.text.currencyPlacement?$(".subtotal .item-price").html(ShadeFinder.text.currency+n.get("subtotal").toFixed(2)):$(".subtotal .item-price").html(n.get("subtotal").toFixed(2)+" "+ShadeFinder.text.currency),$(".cart-items").append(this.sidebarTemplate(this.model.attributes)),$(".sidebar-cart").show(),$(".sidebar").addClass("open"),$(".toggle-close").addClass("active"),$(".toggle-open").removeClass("active"),setTimeout(function(){return $(".sidebar").removeClass("open"),$(".toggle-close").removeClass("active"),$(".toggle-open").addClass("active")},2e3),this.model.set({addedToSidebar:!0}),n.set({numItems:n.get("numItems")+1}),e=$(".sidebar-cart").find(".cart-items").find(".item:visible"),i=3,$(".sidebar-cart .more-items .item-count").text(n.attributes.numItems),t=e.length-i,r=[];t>0;)$(".sidebar-cart").each(function(){var e;e=$($(this).find(".item")[t-1]),e.slideUp(400,function(t){return function(){return e.remove()}}(this))}),r.push(t--);return r}},i.prototype.events={"click .add":function(t){return t.preventDefault(),this.model.addToCart()},"click .learn-more":function(t){var e;if(t.preventDefault(),e=$(t.currentTarget).attr("href"))return window.open(e,"_blank")}},i}(e)}),define("BE.Views.VideoModal",["View"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=_.template('<div class="video-player"><div class="wrapper"><div class="wrapper-inner"><iframe src="<%= baseUrl %><%= video %>&h=<%= height %>&w=<%= width %>" scrolling="no" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div></div></div>'),n.prototype.youtubeTemplate=_.template('<div class="video-player"><div class="wrapper"><div class="wrapper-inner"><iframe src="<%= video %>&autoplay=1" scrolling="no" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div></div></div>'),n.prototype.initialize=function(){return this.model.on("create",this.create,this),this.model.on("change:state",this.state,this),this.model.on("show",this.show,this)},n.prototype.create=function(t){return this.$el=t,this.delegateEvents()},n.prototype.state=function(){var t,e;return t=this.model.get("state"),e=this.model.previous("state"),this.$el.removeClass(e).addClass(t)},n.prototype.show=function(){var t,e,n,i,r,o;return o=$(window),r=o.width(),n=9*r/16,i=o.height()-140,n>i?(e=i,r=16*i/9):e=n,this.model.set({height:e,width:r}),t=this.$el.find(".video-player"),0===this.$el.find(".video-player").length&&(/youtube.com/.exec(this.model.get("video"))?this.$el.append(this.youtubeTemplate(this.model.attributes)):this.$el.append(this.template(this.model.attributes))),this.$el.find(".video-player").height(e).find(".wrapper").width(r),this.model.once("hide",function(t){return function(){return t.$el.find(".video-player").remove()}}(this))},n.prototype.events={"click .hide":function(t){return t.preventDefault(),this.model.trigger("hide")},"click .overlay":function(t){return t.preventDefault(),this.model.trigger("hide")}},n}(e)}),define("BE.Views.MobileNav",["View"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.model.on("change:menu",this.toggle,this)},n.prototype.create=function(t){return this.$el=t,this.delegateEvents()},n.prototype.toggle=function(){return this.model.get("menu")?this.show():this.hide()},n.prototype.show=function(){return this.$el.removeClass("hidden").addClass("visible")},n.prototype.hide=function(){return this.$el.removeClass("visible"),setTimeout(function(t){return function(){return t.$el.addClass("hidden")}}(this),400)},n.prototype.events={"click .navigate":function(t){return t.preventDefault(),this.model.set({menu:!1}),setTimeout(function(e){return function(){var n;return n=$(t.currentTarget),e.model.navigate(n.data("to"),n.data("direction"))}}(this),400)},"click .back":function(t){return t.preventDefault(),this.model.back()},"click .reset":function(t){return t.preventDefault(),this.model.set({menu:!1}),setTimeout(function(t){return function(){return t.model.trigger("reset")}}(this),400)}},n}(e)}),define("BE.Views.MobileFinish",["View","UI"],function(e,n){var i,r;return i=n.Browser,r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.model.on("create",this.create,this),this.model.on("change:position",this.position,this),this.model.on("change:tutoring",this.tutoring,this)},n.prototype.create=function(t){return this.$el=t,this.delegateEvents(),this.tutor=this.$el.parent().find(".tutor-wrap")},n.prototype.tutoring=function(t,e){return e?this.$el.parent().addClass("display-tutoring tutoring"):(this.$el.parent().removeClass("tutoring"),setTimeout(function(t){return function(){return t.$el.parent().removeClass("display-tutoring")}}(this),400))},n.prototype.position=function(t,e){var n;if(n=i.transform("left",-e/3*100+"%"),this.$el.css(n[0],n[1]),this.model.get("tutoring"))return n=i.transform("left",(e-1)*-50+"%"),this.tutor.css(n[0],n[1])},n.prototype.swipe=function(){return this.changed=!1},n.prototype.swiping=function(t,e){return t<-50&&!this.changed?(this.changed=!0,this.model.next()):t>50&&!this.changed?(this.changed=!0,this.model.prev()):void 0},n.prototype.swiped=function(){},n.prototype.events={swipe:"swipe",swiping:"swiping",swiped:"swiped"},n}(e)}),define("BE.Collections.Shade",["Collection"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.on("renderAll",function(t){return function(){var e;return t.$el.empty(),e=t.sortBy(function(t){return"fair"===t.attributes.id?0:"light"===t.attributes.id?1:"medium"===t.attributes.id?2:"tan"===t.attributes.id?3:"dark"===t.attributes.id?4:"deep"===t.attributes.id?5:void 0}),_.each(e,function(e){return e.trigger("destroy create",t.$el)}),t.$el.find(".shade").length<5?t.$el.addClass("shades-min"):t.$el.removeClass("shades-min")}}(this)),this.on("change:active",function(t){return function(e){if(e.get("active")===!0)return t.each(function(t){if(e.cid!==t.cid)return t.set({active:!1})}),t.trigger("render",e)}}(this))},n.prototype.create=function(t){return this.$el=t,this.on("change:active",function(t){return function(e){var n;return n=t.findWhere({active:!0}),t.findWhere({active:!0})?t.$el.addClass("has-active"):t.$el.removeClass("has-active")}}(this))},n.prototype.active=function(){var t;if(t=this.findWhere({active:!0}),null!=t)return t.get("value")},n}(e)}),define("BE.Collections.Product",["Model","Collection","BE.Models.Product","Data"],function(e,n,i,r){var o,s,a,u,c;return u=ShadeFinder.prefix,c=ShadeFinder.urls.products,a={name:ShadeFinder.text.notFound,isAvailable:!1},s=new e,o=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=i,n.prototype.initialize=function(){return this.requests=[],s.on("change:loading",function(t){return function(){return t.trigger("changeLoading",s.get("loading"))}}(this))},n.prototype.abort=function(){var t,e,n,i;for(n=this.requests,e=0,t=n.length;e<t;e++)i=n[e],i.abort();return this.requests=[]},n.prototype.sync=function(t,e,n){var i,o,s,a,u,c;for(a=[],c=this.ids,u=0,o=c.length;u<o;u++)i=c[u],null!=r.products[i]&&(s=r.products[i],a.push({title:s,id:i}));return n.success(a)},n.prototype.sync=function(t,e,n){var i,r,o,d,h,l,p,f,g;for(s.set({loading:!0}),this.abort(),d=[],p=this.ids.length,i=function(t){return function(e){if(d.push(e),0===--p)return t.add(d).trigger("sync"),s.set({loading:!1})}}(this),g=function(t){return function(e){var n,r;return(n=t.findWhere({id:e.id}))?i(n):(r=$.getJSON(c+u+e.id,function(t){return i(_.extend(e,t))}),r.fail(function(){return i(_.extend(e,a))}),t.requests.push(r))}}(this),l=this.ids,f=[],h=0,o=l.length;h<o;h++)r=l[h],f.push(g(r));return f},n.prototype.retrieve=function(t){return this.ids=t,this.fetch()},n}(n)}),define("BE.States",function(){var t;return t=[{id:0,duration:800,animation:"fade-in",continue:!0},{id:1,duration:600,animation:"down-in",continue:!0,nav:0},{id:2,duration:400,animation:"fade-in",continue:!0,nav:0},{id:3,duration:800,continue:!1,nav:0},{id:101,duration:800,continue:!1,nav:0},{id:200,duration:800,animation:"left-out",continue:!0,nav:1},{id:201,duration:100,continue:!0,nav:1},{id:202,duration:100,continue:!0,nav:1},{id:203,duration:100,continue:!0,nav:1},{id:204,duration:100,continue:!0,nav:1},{id:205,duration:100,continue:!0,nav:1},{id:206,duration:100,continue:!0,nav:1},{id:207,duration:800,animation:"fade-in",continue:!1,nav:1},{id:300,duration:100,continue:!0,nav:2},{id:301,duration:100,continue:!0,nav:2},{id:302,duration:100,continue:!0,nav:2},{id:303,duration:100,continue:!0,nav:2},{id:304,duration:800,continue:!1,nav:2},{id:401,duration:400,continue:!0,nav:2},{id:402,duration:400,continue:!0,nav:2},{id:403,duration:400,continue:!0,nav:2},{id:404,duration:800,continue:!1,nav:2},{id:501,duration:400,continue:!0,nav:2},{id:502,duration:200,continue:!0,nav:2},{id:503,duration:200,continue:!0,nav:2},{id:504,duration:200,continue:!0,nav:2},{id:505,duration:200,continue:!0,nav:2},{id:506,duration:400,continue:!1,nav:2},{id:601,duration:800,continue:!1,nav:2},{id:602,duration:800,continue:901,nav:2},{id:700,duration:800,continue:!0,nav:0},{id:701,duration:800,continue:!1,nav:1},{id:801,duration:800,continue:!1,nav:2},{id:802,duration:800,continue:901,nav:2},{id:901,duration:800,continue:!1,nav:2}]}),define("BE.Logic",["BE.Models.Logic","UI"],function(e,n){var i,r,o;return i=n.Cookie,r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return n.__super__.initialize.apply(this,arguments),i.sync(this,"shade undertone","logic")},n}(e),o=new r}),define("BE.Page",["$","UI","BE.Models.Page","BE.Views.Page","BE.States","BE.Logic","BE.StaticStates"],function($,e,n,i,r,o,s){var a,u,c,d;return a=e.Cookie,d=e.Browser.is.IE9()||e.Browser.is.IE8()?s:r,u=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.states=d,n.prototype.initialize=function(){return new i({model:this}),a.sync(this,"state","page"),n.__super__.initialize.apply(this,arguments)},n}(n),c=new u,o.on("navigate",function(t){return c.navigate(t)}),$(function(){return c.trigger("create",$("main"))}),c}),define("BE.Resolve",["$","BE.Models.Resolve","BE.Views.Resolve","BE.Logic","BE.Products"],function($,e,n,i,r){var o,s,a,u,c,d,h;for(o=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(){return new n({model:this}),i.__super__.initialize.apply(this,arguments)},i}(e),h=[new o,new o],i.on("change:foundation change:products change:brush change:family",function(){var t,e,n,r,o;for(r={foundation:i.get("foundation"),products:i.get("products"),brush:i.get("brush")},o=[],e=0,t=h.length;e<t;e++)n=h[e],o.push(n.set({result:r,family:i.get("family")}));return o}),i.on("change:showing",function(){var t,e,n,r,o,s,a;if(1===i.get("showing")){for(o=[],n=0,t=h.length;n<t;n++)r=h[n],o.push(r.set({productsVisible:!1}));return o}for(s=[],a=0,e=h.length;a<e;a++)r=h[a],s.push(r.set({productsVisible:!0}));return s}),r.on("sync",function(){var t,e,n,i;for(i=[],e=0,t=h.length;e<t;e++)n=h[e],i.push(n.trigger("refresh",r));return i}),a=function(){var t,e,n,o,s,a,u,c,d,l,p,f;for(t=[!1,!1],n=i.get("brush"),d=i.get("foundation"),s=c=0,a=d.length;c<a;s=++c)o=d[s],e=r.findWhere({id:n[s],added:!0}),o=r.findWhere({id:o,added:!0}),null==e&&null==o||(t[s]=!0);for(p=[],f=0,u=h.length;f<u;f++)l=h[f],p.push(l.set({addedBoth:t}));return p},r.on("change:added",a),i.on("change:foundation",a),s=function(t){var e,n,o,s;if(e=i.get("brush")[t],o=i.get("foundation")[t],n=r.findWhere({id:e,added:!1}),s=r.findWhere({id:o,added:!1}),null!=n&&n.addToCart(!0),null!=s)return s.addToCart(!0)},c=0,u=h.length;c<u;c++)d=h[c],d.on("addBoth",s);return $(function(){return h[0].trigger("create",$("#Resolve")),h[1].trigger("create",$("#MobileResolve"))}),h}),define("BE.Shades",["$","UI","BE.Models.Shade","BE.Views.Shade","BE.Collections.Shade","BE.Logic","BE.Page"],function($,e,n,i,r,o,s){var a,u,c,d;return a=e.Browser,u=function(n){function r(){return r.__super__.constructor.apply(this,arguments)}return t(r,n),r.prototype.initialize=function(){return new i({model:this}),e.Cookie.sync(this,"active undertone","shade"+this.id),r.__super__.initialize.apply(this,arguments)},r}(n),c=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=u,n.prototype.create=function(t){return this.$el=t,n.__super__.create.apply(this,arguments),this.on("renderAll render refresh",this.refresh),this.on("change:innerHeight change:toggleHeight",a.debounce(this.refresh,400))},n.prototype.refresh=function(){var t;return t=0,this.each(function(e){return e.set({top:t}),t+=e.get("active")?e.get("innerHeight"):e.get("toggleHeight")}),this.$el.parent().height(t)},n}(r),d=new c,o.on("change:shades",function(){var t,e;if(e=o.get("shades").length,6===e?$("#Shades").addClass("-six"):$("#Shades").removeClass("-six"),d.set(o.get("shades")).trigger("renderAll"),t=d.findWhere({active:!0}))return d.trigger("change:active",t)}),d.on("change:active",function(t){var e;return e=d.active(),o.set({shade:e})}),d.on("undertone",function(t){
return o.set({undertone:t}),d.trigger("undertoned",t)}),$(function(){var t,e,n,i,r,o;return d.create($("#Shades")),o=$(".section-5"),e=o.find(".left"),r=o.find(".right"),n=o.find(".container").css("max-width"),n=null!=n?parseFloat(n.replace("px","")):0,t=a.is.IE8(),i=function(i){var r,o;if(r=i.width>n?e.outerWidth(!0)+(i.width-n)/2:e.outerWidth(!0),o=i.width-r,t&&o>1205)return o=1205,r=e.outerWidth(!0)+(1601-n)/2},a.on("resize",i),s.on("change:page",function(){return 6===s.get("page")||8===s.get("page")?(a.on("resize",i),i({width:$(window).width()})):a.off("resize",i)})}),d}),define("BE.Products",["$","UI","BE.Collections.Product","BE.Logic","BE.Cart","BE.Page"],function($,t,e,n,i,r){var o,s,a;return o=t.Browser,s=new e,n.on("change:ids",t.Browser.debounce(function(){return s.retrieve(n.get("ids"))},400)),a=function(t){return i.has(t.id)?t.set({added:!0}):t.set({added:!1})},i.on("change:products",function(){return s.each(a)}),s.on("add",function(){return s.each(a)}),s.on("cart",function(t){return _.isArray(t)||(t=[t]),i.add(t)}),$(function(){var t,e,n,i;return o.is.IE8()||o.is.IE9()?(e=$(".loader").css({visibility:"visible",top:0}).hide(),n=function(t){var n;return n=r.get("page"),t&&9===n?e.show().stop().animate({opacity:.8},400):e.stop().animate({opacity:0},400,function(){return e.hide()})},s.on("changeLoading",n)):(t=$("html"),i=void 0,s.on("changeLoading",function(e){return clearTimeout(i),e?t.addClass("load loading"):(t.removeClass("loading"),i=setTimeout(function(){return t.removeClass("load")},400))}))}),s}),define("BE.Header",["$","BE.Views.Header","BE.Page"],function($,t,e){var n;return n=new t({model:e}),$(function(){return n.create($("header"))}),n}),define("BE.Intro",["$","BE.Models.Intro","BE.Views.Intro","BE.Page","BE.Logic"],function($,e,n,i,r){var o,s;return o=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(){return new n({model:this}),i.__super__.initialize.apply(this,arguments)},i}(e),s=new o({model:i}),i.on("change:page",function(){return s.set({page:i.get("page")}),r.set({page:i.get("page")})}),s.on("change:visible",function(){return s.get("visible")||0!==i.get("page")?s.get("visible")&&1===i.get("page")?i.set({state:3}):void 0:i.set({state:101})}),$(function(){if(s.trigger("create",$("#Intro")),s.trigger("fade",$(".section-1 .background-inner")),i.get("state")>=2)return s.set({position:-1})}),s}),define("BE.Progress",["$","BE.Views.Progress","BE.Logic","BE.Page"],function($,t,e,n){var i,r,o;return r=[new t({model:e}),new t({model:e})],i=!1,r[0].selections(["concern","skintype","finish","coverage","undertone"]),r[0].pages([1,2,3,4,5,6,9]),r[0].track=1,r[1].selections(["family","undertone"]),r[1].pages([1,7,8,9]),r[1].track=2,n.on("change:page",function(){var t,e;if(e=n.previous("page"),t=n.get("page"),!i&&((1===e&&2===t||1===e&&7===t)&&(r[0].animateIn(),i=!0),1===e&&7===t))return r[1].animateIn(),i=!0}),o=function(){switch(e.get("track")){case 1:return r[0].show(),r[1].hide(),$(".sidebar-0").show(),$(".sidebar-1").hide();case 2:return r[1].show(),r[0].hide(),$(".sidebar-1").show(),$(".sidebar-0").hide()}},e.on("change:track",o),$(function(){return r[0].create($(".progress-0")),r[1].create($(".progress-1"))}),r}),define("BE.Match",["$","BE.Views.Match","BE.Logic"],function($,t,e){var n;return n=new t({model:e}),$(function(){var t,i;return i=$(window),n.create($("#Match, #MobileMatch")),t=$(".section-8"),e.on("change:showing",function(){if(i.width()<769)return t.scrollTop(0),setTimeout(function(){return t.scrollTop(0),setTimeout(function(){return t.scrollTop(0)},30)},0)})}),n}),define("BE.Filters",["$","UI","BE.Logic","BE.Page","BE.TouchHovers"],function($,e,n,i,r){var o,s,a,u,c,d,h;d=0,o=function(n){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,n),i.prototype.initialize=function(){var t;return i.__super__.initialize.apply(this,arguments),t=this.get("key"),e.Cookie.sync(this,"active",t+"toggle"+d++)},i}(e.Toggle),s=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=o,n}(e.Toggle.Collection),c={track:{el:".track"},coverage:{el:".coverage"},finish:{el:".glow"},concern:{el:".concerns .icon"},skintype:{el:".types .icon"},family:{el:".family"}},a=function(t,e){return e.collection=(new s).exclusive().on("change:active",function(){var e;if(e={},e[t]=this.active(),"family"===t&&(e[t]=[e[t]]),n.set(e),"track"===t)return i.set(e)})};for(h in c)u=c[h],a(h,u);return $(function(){var t,e;e=1,t=[];for(h in c)u=c[h],r.add($(u.el)),t.push($(u.el).each(function(){var t,n;if(t=$(this),n=u.collection.add({key:h}).last().trigger("create",t),"track"===h&&n.get("active")&&(e=n.get("value")),2===e){if(("family"===h||"track"===h)&&n.get("active"))return n.trigger("change:active",n,n.get("active"))}else if("family"!==h&&n.get("active"))return n.trigger("change:active",n,n.get("active"))}));return t}),c}),define("BE.Reset",["$","BE.Page","BE.Logic","BE.Filters","BE.Shades","BE.Resolve","BE.Products"],function($,t,e,n,i,r,o){var s;return s=function(){var t,s,a,u,c,d;o.each(function(t){return t.trigger("destroy")}),i.each(function(t){return t.set({active:!1})});for(s in n)t=n[s],t.collection.each(function(t){if("track"!==t.get("key"))return t.set({active:!1})});for(e.set({brush:[],products:[],foundation:[],family:[],undertone:void 0,showing:0,usingDefault:!1}),u=0,a=r.length;u<a;u++)c=r[u],c.trigger("reset");return d=$(".scrollable").scrollTop(0),setTimeout(function(){return d.scrollTop(0)},0)},t.on("loaded",function(){return t.on("reset",function(){return setTimeout(s,800)}),e.on("change:track",function(){return s()})}),s}),define("BE.VideoModal",["$","BE.Models.VideoModal","BE.Views.VideoModal","BE.Page"],function($,e,n,i){var r,o;return r=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(){return i.__super__.initialize.apply(this,arguments),new n({model:this})},i}(e),o=new r({duration:400}),i.on("video",function(t){return o.set({video:t}).trigger("show")}),$(function(){return o.trigger("create",$("#VideoModal")),$(".video .thumbnail").on("click",function(t){var e;return t.preventDefault(),e=$(t.target).parent().data("video"),o.set({video:e}).trigger("show")})}),o}),define("BE.Cart",["$","BE.Models.Cart"],function($,t){var e;return e=new t,$(function(){return $(window).focus(function(){return e.fetch({success:function(){}})})}),e}),define("BE.MobileNav",["$","BE.Views.MobileNav","BE.Page"],function($,t,e){var n;return n=new t({model:e}),$(function(){return n.create($(".mobile-nav"))}),n}),define("BE.Tracking",["$","Model","BE.Page","BE.Filters","BE.Products"],function($,e,n,i,r){var o,s,a,u,c;return s=function(){var t;try{return window.self!==window.top}catch(e){return t=e,!0}},o=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){if(null!=window.cmSetClientID)return this.page()},n.prototype.click=function(t,e){return tlCreateConversionEventTag(t,2,e,10,"")},n.prototype.page=function(){var t;return t=s()?window.top.location.href.split("#")[0]:document.referrer},n}(e),u=new o,a=1,c=function(t){return t.on("click",function(){var e;return e=t.data("id"),e&&e.indexOf("Track")>-1?(u.click(e,"Shade Finder - "+t.data("category")),a=t.data("value")):u.click(t.data("value"),"Shade Finder - Track "+a+" - "+t.data("category"))})},$(function(){var t,e,n,o,s,d,h,l,p,f;e=$("#Intro"),e.on("click",".start",function(t){return u.click($(t.target).data("id"),$(t.target).data("category"))});for(n in i)t=i[n],$(t.el).each(function(){return c($(this))});return o=$("#Navigation"),o.on("click",".back",function(t){return u.click($(t.target).data("id"),"Shade Finder - "+$(t.target).data("category"))}),o.on("click",".reset",function(t){return u.click($(t.target).data("id"),"Shade Finder - "+$(t.target).data("category"))}),o.on("click",".close",function(t){return u.click($(t.target).data("id"),"Shade Finder - "+$(t.target).data("category"))}),$(".side-menu .dot").on("click",function(t){return u.click($(t.target).data("id"),"Shade Finder - "+$(t.target).data("category"))}),p=$(".section-1"),h=$("#Shades"),h.on("click",".shade .toggle",function(t){var e;return e=$(t.currentTarget).parent().data("value"),u.click(e[0].toUpperCase()+e.substring(1),"Shade Finder - Track "+a+" - "+$(t.currentTarget).parent().data("category"))}),h.on("click",".undertone",function(t){return u.click($(t.currentTarget).data("value"),"Shade Finder - Track "+a+" - "+$(t.currentTarget).data("category"))}),s=$("#Resolve, #MobileResolve"),s.on("click","a, .learn-more",function(){var t;if(t=$(this),!t.hasClass("video"))return u.click(t.attr("href"))}),r.on("cart",function(t,e){if(!e)return u.click("#AddToCart-"+t)}),s.on("click",".toggle-match",function(t){return u.click($(t.currentTarget).data("id"),"Shade Finder - "+$(t.currentTarget).data("category"))}),s.on("click",".add-both",function(){return u.click("#AddBoth")}),f=$("#VideoModal"),f.on("click",".hide",function(t){return u.click($(t.currentTarget).data("id"),$(t.currentTarget).data("category"))}),l=$("#TipsModal"),l.on("click",".thumbnail",function(t){return u.click($(t.currentTarget).parent().data("id"),$(t.currentTarget).parent().data("category"))}),d=$(".matches")}),u}),define("BE.MobileFinish",["$","BE.Models.MobileFinish","BE.Views.MobileFinish","BE.Page"],function($,e,n,i){var r,o;return r=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return t(i,e),i.prototype.initialize=function(){return new n({model:this}),i.__super__.initialize.apply(this,arguments)},i}(e),o=new r,i.on("change:page",function(){var t,e;return e=i.previous("page"),t=i.get("page"),3===e&&4===t?o.trigger("tutorial",1200):4===t?o.trigger("tutorial"):void 0}),$(function(){return o.trigger("create",$(".section-3 .wrapper"))})}),define("BE.TipsModal",["$","UI","View"],function($,e,n){var i,r,o;return r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.model.on("create",this.create,this),this.model.on("change:state",this.state,this)},n.prototype.create=function(t){return this.$el=t,this.delegateEvents()},n.prototype.state=function(){var t,e;return t=this.model.get("state"),e=this.model.previous("state"),this.$el.removeClass(e).addClass(t)},n.prototype.events={"click .hide":function(t){return t.preventDefault(),this.model.trigger("hide")},"click .overlay":function(t){return t.preventDefault(),this.model.trigger("hide")}},n}(n),i=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return n.__super__.initialize.apply(this,arguments),new r({model:this})},n}(e.Modal),o=new i({duration:400}),$(function(){return o.trigger("create",$("#TipsModal")),$(".show-tips").on("click",function(t){return t.preventDefault(),o.trigger("show")})}),o}),define("BE.TouchHovers",["$","UI"],function($,t){var e,n,i;return e=t.Events.Drag,i=void 0,n=function(t){return i=i||e({$el:$(document),suffix:".touchhoversbody",min:0,preventable:!1}),t.each(function(){var t,n;return n=$(this),t=e({$el:n,suffix:".touchhovers",min:0,preventable:!1}),t.on("start",function(){return i.once("end",function(){return n.removeClass("hover")}),n.addClass("hover")})})},$(function(){return n($("button, a"))}),{add:n}}),define("BE.StaticStates",function(){var t;return t=[{id:0,duration:0,continue:!0},{id:1,duration:0,continue:!0,nav:0},{id:2,duration:0,continue:!0,nav:0},{id:3,duration:0,continue:!1,nav:0},{id:101,duration:0,continue:!1,nav:0},{id:200,duration:0,animation:"left-out",continue:!0,nav:0},{id:201,duration:0,continue:!0,nav:1},{id:202,duration:0,continue:!0,nav:1},{id:203,duration:0,continue:!0,nav:1},{id:204,duration:0,continue:!0,nav:1},{id:205,duration:0,continue:!0,nav:1},{id:206,duration:0,continue:!0,nav:1},{id:207,duration:0,animation:"fade-in",continue:!1,nav:1},{id:300,duration:0,continue:!0,nav:2},{id:301,duration:0,continue:!0,nav:2},{id:302,duration:0,continue:!0,nav:2},{id:303,duration:0,continue:!0,nav:2},{id:304,duration:0,continue:!1,nav:2},{id:401,duration:0,continue:!0,nav:2},{id:402,duration:0,continue:!0,nav:2},{id:403,duration:0,continue:!0,nav:2},{id:404,duration:0,continue:!1,nav:2},{id:501,duration:0,continue:!0,nav:2},{id:502,duration:0,continue:!0,nav:2},{id:503,duration:0,continue:!0,nav:2},{id:504,duration:0,continue:!0,nav:2},{id:505,duration:0,continue:!0,nav:2},{id:506,duration:0,continue:!1,nav:2},{id:601,duration:0,continue:!1,nav:2},{id:602,duration:0,continue:901,nav:2},{id:700,duration:0,continue:!0,nav:0},{id:701,duration:0,continue:!1,nav:1},{id:801,duration:0,continue:!1,nav:2},{id:802,duration:0,continue:901,nav:2},{id:901,duration:0,continue:!1,nav:2}]}),define("Backbone.Events",["View","UI"],function(t,e){var n;return n=e.Events,t.prototype.events={},t.prototype.delegateEventSplitter=/^(\S+)\s*(.*)$/,t.prototype.delegateEvents=function(t){var e,i,r;this.undelegateEvents(),this.unlisten=[],t=t||this.events,e=function(t){return function(e,i){var r,o,s;return o=e.match(t.delegateEventSplitter),r=o[1],s=o[2],""===s&&(s=null),"string"==typeof i&&(i=t[i]),n[r]?n[r].call(t,".delegateEvents"+t.cid,s,function(){return i.apply(t,arguments)}):t.$el.on(r+".delegateEvents"+t.cid,s,function(){return i.apply(t,arguments)})}}(this);for(i in t)r=t[i],e(i,r);return this},t.prototype.undelegateEvents=function(){var t,e,n,i;if(this.$el&&this.$el.off(".delegateEvents"+this.cid),this.unlisten)for(n=this.unlisten,e=0,t=n.length;e<t;e++)(i=n[e])();return this}}),define("$",function(){return $}),define("Model",function(){return Backbone.Model}),define("View",function(){return Backbone.View}),define("Collection",function(){return Backbone.Collection}),require(["Backbone.Events","$","UI","BE.Page","BE.Logic","BE.Shades","BE.Resolve","BE.Products","BE.Header","BE.Intro","BE.Progress","BE.Match","BE.Filters","BE.Reset","BE.VideoModal","BE.Cart","BE.MobileNav","BE.Tracking","BE.MobileFinish","BE.TipsModal","BE.TouchHovers"],function(t,$,e,n){var i,r,o,s,a,u,c;if(o=function(){var t;try{return window.self!==window.top}catch(e){return t=e,!0}},i=e.Browser.debounce(function(){return $("<style></style>").appendTo($(document.body)).remove()},400),window.hijackjQuery=function(t){var e;return e=$.fn[t],$.fn[t]=function(){return e.apply(this,arguments),i()}},e.Browser.is.android()&&e.Browser.isnt.chrome())for(c=["html","height","css"],u=0,s=c.length;u<s;u++)r=c[u],hijackjQuery(r);return $(function(){var t,n;return n=$("main, body, html"),t=void 0,e.Browser.on("resize",function(e){return cancelAnimationFrame(t),t=requestAnimationFrame(function(){return n.css({height:e.height,width:e.width})}),$("section").each(function(){return $(this).css({height:e.height}),$(this).hasClass("progress-section")?$(this).css({width:e.width-60}):$(this).css({width:e.width})})}),e.Browser.on("change:input",function(){var t,n;return n=e.Browser.previous("input"),t=e.Browser.get("input"),$("html").removeClass("has-"+n).addClass("has-"+t)}),$(".middle").each(function(){return(new e.Middle).trigger("create",$(this))}),e.Browser.is.windows()&&e.Browser.is.firefox()?$("html").addClass("windows-firefox"):e.Browser.is.windows()&&e.Browser.is.chrome()?$("html").addClass("windows-chrome"):e.Browser.is.android()&&e.Browser.isnt.chrome()?$("html").addClass("stock-android"):e.Browser.is.IE10()?$("html").addClass("ie10"):e.Browser.is.IE9()?$("html").addClass("ie9"):e.Browser.is.IE8()&&$("html").addClass("ie8"),o()?$("html").addClass("in-iframe"):$("html").addClass("no-iframe")}),a=function(){return e.Browser.resize(),setTimeout(function(){return n.trigger("change:state loaded",n,n.get("state"))},400)},o()?(parent.ShadeFinder.load(a),n.on("close",function(){return parent.ShadeFinder.close()})):"complete"===document.readyState?a():window.onload=a})}).call(this);