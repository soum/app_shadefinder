(function(){var t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},e={}.hasOwnProperty;null==Date.now&&(Date.now=function(){return(new Date).getTime()}),define("UI.Animator",function(){var t;return t=function(e,n,i,r,o,u){var s,a,c,h,d,l,f,p,g,v,m,y,w,_;return null==i&&(i=0),h=t.easing[r]||t.easing.swing,y=e,c=n-e,a=e,m=Date.now(),p=m,g=!0,s=void 0,d=Date.now(),f=function(){return g?void 0:(g=!0,cancelAnimationFrame(s),p=Date.now())},_=function(){return f()},v=function(){return g?(g=!1,m+=Date.now()-p,s=requestAnimationFrame(w)):void 0},l=function(){return!1},w=function(){var t,r;return t=Date.now()-m,r=1-(i-t)/i,i>t&&!g?(l()||(a=h(r,t,e,c,i),o&&o(a),d=Date.now()),s=requestAnimationFrame(w)):(a=h(r,i,e,c,i),o&&o(n),u&&u())},v(),{resume:v,pause:f,stop:_}},t.easing={linear:function(t,e,n,i,r){return n+t*i},swing:function(t,e,n,i,r){return n+(.5-Math.cos(t*Math.PI)/2)*i},easeInQuad:function(t,e,n,i,r){return i*(e/=r)*e+n},easeOutQuad:function(t,e,n,i,r){return-i*(e/=r)*(e-2)+n},easeInOutQuad:function(t,e,n,i,r){return(e/=r/2)<1?i/2*e*e+n:-i/2*(--e*(e-2)-1)+n},easeInCubic:function(t,e,n,i,r){return i*(e/=r)*e*e+n},easeOutCubic:function(t,e,n,i,r){return i*((e=e/r-1)*e*e+1)+n},easeInOutCubic:function(t,e,n,i,r){return(e/=r/2)<1?i/2*e*e*e+n:i/2*((e-=2)*e*e+2)+n},easeInQuart:function(t,e,n,i,r){return i*(e/=r)*e*e*e+n},easeOutQuart:function(t,e,n,i,r){return-i*((e=e/r-1)*e*e*e-1)+n},easeInOutQuart:function(t,e,n,i,r){return(e/=r/2)<1?i/2*e*e*e*e+n:-i/2*((e-=2)*e*e*e-2)+n},easeInQuint:function(t,e,n,i,r){return i*(e/=r)*e*e*e*e+n},easeOutQuint:function(t,e,n,i,r){return i*((e=e/r-1)*e*e*e*e+1)+n},easeInOutQuint:function(t,e,n,i,r){return(e/=r/2)<1?i/2*e*e*e*e*e+n:i/2*((e-=2)*e*e*e*e+2)+n},easeInSine:function(t,e,n,i,r){return-i*Math.cos(e/r*(Math.PI/2))+i+n},easeOutSine:function(t,e,n,i,r){return i*Math.sin(e/r*(Math.PI/2))+n},easeInOutSine:function(t,e,n,i,r){return-i/2*(Math.cos(Math.PI*e/r)-1)+n},easeInExpo:function(t,e,n,i,r){var o;return null!=(o=0===e)?o:{b:i*Math.pow(2,10*(e/r-1))+n}},easeOutExpo:function(t,e,n,i,r){var o;return null!=(o=e===r)?o:n+{c:i*(-Math.pow(2,-10*e/r)+1)+n}},easeInOutExpo:function(t,e,n,i,r){return 0===e?n:e===r?n+i:(e/=r/2)<1?i/2*Math.pow(2,10*(e-1))+n:i/2*(-Math.pow(2,-10*--e)+2)+n},easeInCirc:function(t,e,n,i,r){return-i*(Math.sqrt(1-(e/=r)*e)-1)+n},easeOutCirc:function(t,e,n,i,r){return i*Math.sqrt(1-(e=e/r-1)*e)+n},easeInOutCirc:function(t,e,n,i,r){return(e/=r/2)<1?-i/2*(Math.sqrt(1-e*e)-1)+n:i/2*(Math.sqrt(1-(e-=2)*e)+1)+n},easeInElastic:function(t,e,n,i,r){var o,u,s;return s=1.70158,u=0,o=i,0===e?n:1===(e/=r)?n+i:(u||(u=.3*r),o<Math.abs(i)?(o=i,s=u/4):s=u/(2*Math.PI)*Math.asin(i/o),-(o*Math.pow(2,10*(e-=1))*Math.sin((e*r-s)*(2*Math.PI)/u))+n)},easeOutElastic:function(t,e,n,i,r){var o,u,s;return s=1.70158,u=0,o=i,0===e?n:1===(e/=r)?n+i:(u||(u=.3*r),o<Math.abs(i)?(o=i,s=u/4):s=u/(2*Math.PI)*Math.asin(i/o),o*Math.pow(2,-10*e)*Math.sin((e*r-s)*(2*Math.PI)/u)+i+n)},easeInOutElastic:function(t,e,n,i,r){var o,u,s;return s=1.70158,u=0,o=i,0===e?n:2===(e/=r/2)?n+i:(u||(u=r*(.3*1.5)),o<Math.abs(i)?(o=i,s=u/4):s=u/(2*Math.PI)*Math.asin(i/o),1>e?-.5*(o*Math.pow(2,10*(e-=1))*Math.sin((e*r-s)*(2*Math.PI)/u))+n:o*Math.pow(2,-10*(e-=1))*Math.sin((e*r-s)*(2*Math.PI)/u)*.5+i+n)},easeInBack:function(t,e,n,i,r,o){return null==o&&(o=1.70158),i*(e/=r)*e*((o+1)*e-o)+n},easeOutBack:function(t,e,n,i,r,o){return null==o&&(o=1.70158),i*((e=e/r-1)*e*((o+1)*e+o)+1)+n},easeInOutBack:function(t,e,n,i,r,o){return null==o&&(o=1.70158),(e/=r/2)<1?i/2*(e*e*(((o*=1.525)+1)*e-o))+n:i/2*((e-=2)*e*(((o*=1.525)+1)*e+o)+2)+n},easeInBounce:function(e,n,i,r,o){return r-t.easing.easeOutBounce(e,o-n,0,r,o)+i},easeOutBounce:function(t,e,n,i,r){return(e/=r)<1/2.75?i*(7.5625*e*e)+n:2/2.75>e?i*(7.5625*(e-=1.5/2.75)*e+.75)+n:2.5/2.75>e?i*(7.5625*(e-=2.25/2.75)*e+.9375)+n:i*(7.5625*(e-=2.625/2.75)*e+.984375)+n},easeInOutBounce:function(e,n,i,r,o){return o/2>n?.5*t.easing.easeInBounce(e,2*n,0,r,o)+i:.5*t.easing.easeOutBounce(e,2*n-o,0,r,o)+.5*r+i}},t}),define("UI.Browser",["$","Model"],function($,e){var n,i,r;return r=function(t){var e;return e={},function(n){return e[n]||(e[n]=t(n)),e[n]}},i=function(t){var e,n,i,r;return e=document.createElement("div"),r=["Khtml","ms","O","Moz","Webkit"],n=r.length,(i=function(t){if(t in e.style)return t;for(t=t.replace(/^[a-z]/,function(t){return t.toUpperCase()});n--;)if(r[n]+t in e.style)return"-"+r[n].toLowerCase()+"-"+t.toLowerCase()})(t)},new(n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={breakpoints:{},breakpoint:void 0,hasMouse:void 0},n.prototype.initialize=function(){var t;return this.win=$(window),this.doc=$(document),this.win.resize(function(t){return function(){return cancelAnimationFrame(t.frame),t.frame=requestAnimationFrame(function(){return t.resize()})}}(this)),this.win.scroll(function(t){return function(){return t.scroll()}}(this)),t=this.debounce(function(t){return function(){return t.mouseend()}}(this),400),this.doc.on("mousemove",function(e){return function(n){return e.mousemove(n),t()}}(this)),this.doc.on("touchmove",function(t){return function(e){return t.touchmove(e)}}(this)),this.doc.on("touchend",function(t){return function(e){return t.touchend(e)}}(this))},n.prototype.is={IOS:function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},touch:function(){return"ontouchstart"in window||"onmsgesturechange"in window},retina:function(){return window.devicePixelRatio>1},firefox:function(){return/(Firefox)/g.test(navigator.userAgent)},windows:function(){return/(Windows)/g.test(navigator.userAgent)},chrome:function(){return/(Chrome)/g.test(navigator.userAgent)},android:function(){return/(Android)/gi.test(navigator.userAgent)},IE10:function(){return/(MSIE 10)/g.test(navigator.userAgent)},IE9:function(){return/(MSIE 9)/g.test(navigator.userAgent)},IE8:function(){return/(MSIE 8)/g.test(navigator.userAgent)}},n.prototype.isnt={IOS:function(){return!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},touch:function(){return!1 in window&&!1 in window},retina:function(){return window.devicePixelRatio<=1},firefox:function(){return!/(Firefox)/g.test(navigator.userAgent)},windows:function(){return!/(Windows)/g.test(navigator.userAgent)},chrome:function(){return!/(Chrome)/g.test(navigator.userAgent)},android:function(){return!/(Android)/gi.test(navigator.userAgent)},IE10:function(){return!/(MSIE 10)/g.test(navigator.userAgent)},IE9:function(){return!/(MSIE 9)/g.test(navigator.userAgent)},IE8:function(){return!/(MSIE 8)/g.test(navigator.userAgent)}},n.prototype.breakpoint=function(t){return this.set({breakpoints:t}),this.on("resize",function(t){return function(e){var n,i,r,o;i=t.get("breakpoints"),r=[];for(n in i){if(o=i[n],o>e.width){t.set({breakpoint:n});break}r.push(void 0)}return r}}(this)),this},n.prototype.data=function(){var t,e,n,i,r;return r=this.win,n=this.doc.scrollTop(),t=r.height(),e=window.innerHeight,t>e&&(t=e),i=r.width(),{top:n,height:t,width:i,center:n+t/2,bottom:n+t}},n.prototype.resize=function(){return this.trigger("resize",this.data()),clearTimeout(this.transitionTimeout),this.transitionTimeout=setTimeout(function(t){return function(){return t.trigger("resize",t.data())}}(this),500),this},n.prototype.scroll=function(){return this.trigger("scroll",{top:this.doc.scrollTop()}),this},n.prototype.mousemove=function(t){return this.mousing=this.mousing||[t.pageX,t.pageY],Math.abs(t.pageX-this.mousing[0])+Math.abs(t.pageY-this.mousing[1])>40?this.set({input:"mouse"}):void 0},n.prototype.mouseend=function(t){return delete this.mousing},n.prototype.touchmove=function(t){var e;return e=t.originalEvent.touches[0],this.touching=this.touching||[e.pageX,e.pageY],Math.abs(e.pageX-this.touching[0])+Math.abs(e.pageY-this.touching[1])>40?this.set({input:"touch"}):void 0},n.prototype.touchend=function(t){return delete this.touching},n.prototype.memoize=r,n.prototype.has=r(i),n.prototype.debounce=function(t,e,n){var i,r,o,u,s;return u=void 0,i=void 0,r=void 0,s=void 0,o=void 0,function(){var a,c;return r=this,i=arguments,s=new Date,c=function(a){return function(){var a;return a=new Date-s,e>a?u=setTimeout(c,e-a):(u=null,n?void 0:o=t.apply(r,i))}}(this),a=n&&!u,u||(u=setTimeout(c,e)),a&&(o=t.apply(r,i)),o}},n.prototype.dedupe=function(t,e,n){var i;return i=0,function(){var r;return r=this,new Date-i>e?(t.apply(r,arguments),i=new Date):null!=n?n.apply(r,arguments):void 0}},n.prototype.transform=function(t,e){var n;if(n=this.has("transform"))switch(t){case"left":return[n,"translateX("+e+")"];case"top":return[n,"translateY("+e+")"]}else switch(t){case"left":return["left",e];case"top":return["top",e]}},n.prototype.listen=function(t,e,n){var i,r,o,u,s;for(o=["webkit","moz","MS","o",""],s=[],r=i=0,u=o.length;u>=0?u>=i:i>=u;r=u>=0?++i:--i)o[r]||(e=e.toLowerCase()),"function"==typeof t.addEventListener?s.push(t.addEventListener(o[r]+e,n,!1)):s.push(void 0);return s},n}(e))}),define("UI.Middle",["$","Model","View","UI.Browser"],function($,e,n,i){var r,o;return r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={height:void 0,outer:void 0},n.prototype.initialize=function(){return new o({model:this})},n}(e),o=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return i.on("resize",i.debounce(this.resize,200),this),this.model.on("change:height change:outer",this.position,this),this.model.on("create",this.create,this)},n.prototype.create=function(t){return this.$el=t,this.parent=this.$el.parent(),this.resize()},n.prototype.resize=function(){var t,e;return t=this.$el.outerHeight(),e=this.parent.outerHeight(),this.model.set({height:t,outer:e})},n.prototype.position=function(){var t,e;return t=(this.model.get("outer")-this.model.get("height"))/2,e=i.transform("top",parseInt(t)+"px"),this.$el.css(e[0],e[1])},n}(n),r}),define("UI.Toggle",["$","Model","View","Collection","UI.Cookie"],function($,e,n,i,r){var o,u,s,a;return a=0,o=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={active:!1},n.prototype.initialize=function(){return new s({model:this})},n}(e),s=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.model.on("change:active",this.active,this),this.model.on("create",this.create,this),this.model.on("showButton",this.show,this),this.model.on("hideButton",this.hide,this)},n.prototype.create=function(t){return this.$el=t,this.model.set({value:this.$el.data("value")}),this.$el.find(".toggle").length?this.delegateEvents({"click .toggle":this.events.click}):this.delegateEvents(),this.active(this.model,this.model.get("active"))},n.prototype.active=function(t,e){return e?(this.$el.addClass("active"),this.$el.parent().addClass("active-"+this.model.get("i"))):(this.$el.removeClass("active"),this.$el.parent().removeClass("active-"+this.model.get("i")))},n.prototype.show=function(){return this.$el.parents(".content").find("button").removeClass("hidden")},n.prototype.hide=function(){return this.$el.parents(".content").find("button").addClass("hidden")},n.prototype.events={click:function(t){return t.preventDefault(),this.model.set({active:!0})}},n}(n),u=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=o,n.prototype.initialize=function(){return this.on("add",function(){return this.each(function(t,e){return t.set({i:e})})}),this.on("change:active",function(t){return function(){return t.where({active:!0}).length>0?t.first().trigger("showButton"):t.first().trigger("hideButton")}}(this))},n.prototype.exclusive=function(){return this.on("change:active",function(t){return function(e){return e.get("active")===!0?t.each(function(t){return e.cid!==t.cid?t.set({active:!1}):void 0}):void 0}}(this))},n.prototype.active=function(){var t;return t=this.findWhere({active:!0}),null!=t?t.get("value"):void 0},n}(i),o.Collection=u,o}),define("UI.Browser",["$","Model"],function($,e){var n,i,r;return r=function(t){var e;return e={},function(n){return e[n]||(e[n]=t(n)),e[n]}},i=function(t){var e,n,i,r;return e=document.createElement("div"),r=["Khtml","ms","O","Moz","Webkit"],n=r.length,(i=function(t){if(t in e.style)return t;for(t=t.replace(/^[a-z]/,function(t){return t.toUpperCase()});n--;)if(r[n]+t in e.style)return"-"+r[n].toLowerCase()+"-"+t.toLowerCase()})(t)},new(n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={breakpoints:{},breakpoint:void 0,hasMouse:void 0},n.prototype.initialize=function(){var t;return this.win=$(window),this.doc=$(document),this.win.resize(function(t){return function(){return cancelAnimationFrame(t.frame),t.frame=requestAnimationFrame(function(){return t.resize()})}}(this)),this.win.scroll(function(t){return function(){return t.scroll()}}(this)),t=this.debounce(function(t){return function(){return t.mouseend()}}(this),400),this.doc.on("mousemove",function(e){return function(n){return e.mousemove(n),t()}}(this)),this.doc.on("touchmove",function(t){return function(e){return t.touchmove(e)}}(this)),this.doc.on("touchend",function(t){return function(e){return t.touchend(e)}}(this))},n.prototype.is={IOS:function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},touch:function(){return"ontouchstart"in window||"onmsgesturechange"in window},retina:function(){return window.devicePixelRatio>1},firefox:function(){return/(Firefox)/g.test(navigator.userAgent)},windows:function(){return/(Windows)/g.test(navigator.userAgent)},chrome:function(){return/(Chrome)/g.test(navigator.userAgent)},android:function(){return/(Android)/gi.test(navigator.userAgent)},IE10:function(){return/(MSIE 10)/g.test(navigator.userAgent)},IE9:function(){return/(MSIE 9)/g.test(navigator.userAgent)},IE8:function(){return/(MSIE 8)/g.test(navigator.userAgent)}},n.prototype.isnt={IOS:function(){return!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},touch:function(){return!1 in window&&!1 in window},retina:function(){return window.devicePixelRatio<=1},firefox:function(){return!/(Firefox)/g.test(navigator.userAgent)},windows:function(){return!/(Windows)/g.test(navigator.userAgent)},chrome:function(){return!/(Chrome)/g.test(navigator.userAgent)},android:function(){return!/(Android)/gi.test(navigator.userAgent)},IE10:function(){return!/(MSIE 10)/g.test(navigator.userAgent)},IE9:function(){return!/(MSIE 9)/g.test(navigator.userAgent)},IE8:function(){return!/(MSIE 8)/g.test(navigator.userAgent)}},n.prototype.breakpoint=function(t){return this.set({breakpoints:t}),this.on("resize",function(t){return function(e){var n,i,r,o;i=t.get("breakpoints"),r=[];for(n in i){if(o=i[n],o>e.width){t.set({breakpoint:n});break}r.push(void 0)}return r}}(this)),this},n.prototype.data=function(){var t,e,n,i,r;return r=this.win,n=this.doc.scrollTop(),t=r.height(),e=window.innerHeight,t>e&&(t=e),i=r.width(),{top:n,height:t,width:i,center:n+t/2,bottom:n+t}},n.prototype.resize=function(){return this.trigger("resize",this.data()),clearTimeout(this.transitionTimeout),this.transitionTimeout=setTimeout(function(t){return function(){return t.trigger("resize",t.data())}}(this),500),this},n.prototype.scroll=function(){return this.trigger("scroll",{top:this.doc.scrollTop()}),this},n.prototype.mousemove=function(t){return this.mousing=this.mousing||[t.pageX,t.pageY],Math.abs(t.pageX-this.mousing[0])+Math.abs(t.pageY-this.mousing[1])>40?this.set({input:"mouse"}):void 0},n.prototype.mouseend=function(t){return delete this.mousing},n.prototype.touchmove=function(t){var e;return e=t.originalEvent.touches[0],this.touching=this.touching||[e.pageX,e.pageY],Math.abs(e.pageX-this.touching[0])+Math.abs(e.pageY-this.touching[1])>40?this.set({input:"touch"}):void 0},n.prototype.touchend=function(t){return delete this.touching},n.prototype.memoize=r,n.prototype.has=r(i),n.prototype.debounce=function(t,e,n){var i,r,o,u,s;return u=void 0,i=void 0,r=void 0,s=void 0,o=void 0,function(){var a,c;return r=this,i=arguments,s=new Date,c=function(a){return function(){var a;return a=new Date-s,e>a?u=setTimeout(c,e-a):(u=null,n?void 0:o=t.apply(r,i))}}(this),a=n&&!u,u||(u=setTimeout(c,e)),a&&(o=t.apply(r,i)),o}},n.prototype.dedupe=function(t,e,n){var i;return i=0,function(){var r;return r=this,new Date-i>e?(t.apply(r,arguments),i=new Date):null!=n?n.apply(r,arguments):void 0}},n.prototype.transform=function(t,e){var n;if(n=this.has("transform"))switch(t){case"left":return[n,"translateX("+e+")"];case"top":return[n,"translateY("+e+")"]}else switch(t){case"left":return["left",e];case"top":return["top",e]}},n.prototype.listen=function(t,e,n){var i,r,o,u,s;for(o=["webkit","moz","MS","o",""],s=[],r=i=0,u=o.length;u>=0?u>=i:i>=u;r=u>=0?++i:--i)o[r]||(e=e.toLowerCase()),"function"==typeof t.addEventListener?s.push(t.addEventListener(o[r]+e,n,!1)):s.push(void 0);return s},n}(e))}),define("UI.Middle",["$","Model","View","UI.Browser"],function($,e,n,i){var r,o;return r=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={height:void 0,outer:void 0},n.prototype.initialize=function(){return new o({model:this})},n}(e),o=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return i.on("resize",i.debounce(this.resize,200),this),this.model.on("change:height change:outer",this.position,this),this.model.on("create",this.create,this)},n.prototype.create=function(t){return this.$el=t,this.parent=this.$el.parent(),this.resize()},n.prototype.resize=function(){var t,e;return t=this.$el.outerHeight(),e=this.parent.outerHeight(),this.model.set({height:t,outer:e})},n.prototype.position=function(){var t,e;return t=(this.model.get("outer")-this.model.get("height"))/2,e=i.transform("top",parseInt(t)+"px"),this.$el.css(e[0],e[1])},n}(n),r}),define("UI.Toggle",["$","Model","View","Collection","UI.Cookie"],function($,e,n,i,r){var o,u,s,a;return a=0,o=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={active:!1},n.prototype.initialize=function(){return new s({model:this})},n}(e),s=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.model.on("change:active",this.active,this),this.model.on("create",this.create,this),this.model.on("showButton",this.show,this),this.model.on("hideButton",this.hide,this)},n.prototype.create=function(t){return this.$el=t,this.model.set({value:this.$el.data("value")}),this.$el.find(".toggle").length?this.delegateEvents({"click .toggle":this.events.click}):this.delegateEvents(),this.active(this.model,this.model.get("active"))},n.prototype.active=function(t,e){return e?(this.$el.addClass("active"),this.$el.parent().addClass("active-"+this.model.get("i"))):(this.$el.removeClass("active"),this.$el.parent().removeClass("active-"+this.model.get("i")))},n.prototype.show=function(){return this.$el.parents(".content").find("button").removeClass("hidden")},n.prototype.hide=function(){return this.$el.parents(".content").find("button").addClass("hidden")},n.prototype.events={click:function(t){return t.preventDefault(),this.model.set({active:!0})}},n}(n),u=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=o,n.prototype.initialize=function(){return this.on("add",function(){return this.each(function(t,e){return t.set({i:e})})}),this.on("change:active",function(t){return function(){return t.where({active:!0}).length>0?t.first().trigger("showButton"):t.first().trigger("hideButton")}}(this))},n.prototype.exclusive=function(){return this.on("change:active",function(t){return function(e){return e.get("active")===!0?t.each(function(t){return e.cid!==t.cid?t.set({active:!1}):void 0}):void 0}}(this))},n.prototype.active=function(){var t;return t=this.findWhere({active:!0}),null!=t?t.get("value"):void 0},n}(i),o.Collection=u,o}),null==Date.now&&(Date.now=function(){return(new Date).getTime()}),define("UI.Animator",function(){var t;return t=function(e,n,i,r,o,u){var s,a,c,h,d,l,f,p,g,v,m,y,w,_;return null==i&&(i=0),h=t.easing[r]||t.easing.swing,y=e,c=n-e,a=e,m=Date.now(),p=m,g=!0,s=void 0,d=Date.now(),f=function(){return g?void 0:(g=!0,cancelAnimationFrame(s),p=Date.now())},_=function(){return f()},v=function(){return g?(g=!1,m+=Date.now()-p,s=requestAnimationFrame(w)):void 0},l=function(){return!1},w=function(){var t,r;return t=Date.now()-m,r=1-(i-t)/i,i>t&&!g?(l()||(a=h(r,t,e,c,i),o&&o(a),d=Date.now()),s=requestAnimationFrame(w)):(a=h(r,i,e,c,i),o&&o(n),u&&u())},v(),{resume:v,pause:f,stop:_}},t.easing={linear:function(t,e,n,i,r){return n+t*i},swing:function(t,e,n,i,r){return n+(.5-Math.cos(t*Math.PI)/2)*i},easeInQuad:function(t,e,n,i,r){return i*(e/=r)*e+n},easeOutQuad:function(t,e,n,i,r){return-i*(e/=r)*(e-2)+n},easeInOutQuad:function(t,e,n,i,r){return(e/=r/2)<1?i/2*e*e+n:-i/2*(--e*(e-2)-1)+n},easeInCubic:function(t,e,n,i,r){return i*(e/=r)*e*e+n},easeOutCubic:function(t,e,n,i,r){return i*((e=e/r-1)*e*e+1)+n},easeInOutCubic:function(t,e,n,i,r){return(e/=r/2)<1?i/2*e*e*e+n:i/2*((e-=2)*e*e+2)+n},easeInQuart:function(t,e,n,i,r){return i*(e/=r)*e*e*e+n},easeOutQuart:function(t,e,n,i,r){return-i*((e=e/r-1)*e*e*e-1)+n},easeInOutQuart:function(t,e,n,i,r){return(e/=r/2)<1?i/2*e*e*e*e+n:-i/2*((e-=2)*e*e*e-2)+n},easeInQuint:function(t,e,n,i,r){return i*(e/=r)*e*e*e*e+n},easeOutQuint:function(t,e,n,i,r){return i*((e=e/r-1)*e*e*e*e+1)+n},easeInOutQuint:function(t,e,n,i,r){return(e/=r/2)<1?i/2*e*e*e*e*e+n:i/2*((e-=2)*e*e*e*e+2)+n},easeInSine:function(t,e,n,i,r){return-i*Math.cos(e/r*(Math.PI/2))+i+n},easeOutSine:function(t,e,n,i,r){return i*Math.sin(e/r*(Math.PI/2))+n},easeInOutSine:function(t,e,n,i,r){return-i/2*(Math.cos(Math.PI*e/r)-1)+n},easeInExpo:function(t,e,n,i,r){var o;return null!=(o=0===e)?o:{b:i*Math.pow(2,10*(e/r-1))+n}},easeOutExpo:function(t,e,n,i,r){var o;return null!=(o=e===r)?o:n+{c:i*(-Math.pow(2,-10*e/r)+1)+n}},easeInOutExpo:function(t,e,n,i,r){return 0===e?n:e===r?n+i:(e/=r/2)<1?i/2*Math.pow(2,10*(e-1))+n:i/2*(-Math.pow(2,-10*--e)+2)+n},easeInCirc:function(t,e,n,i,r){return-i*(Math.sqrt(1-(e/=r)*e)-1)+n},easeOutCirc:function(t,e,n,i,r){return i*Math.sqrt(1-(e=e/r-1)*e)+n},easeInOutCirc:function(t,e,n,i,r){return(e/=r/2)<1?-i/2*(Math.sqrt(1-e*e)-1)+n:i/2*(Math.sqrt(1-(e-=2)*e)+1)+n},easeInElastic:function(t,e,n,i,r){var o,u,s;return s=1.70158,u=0,o=i,0===e?n:1===(e/=r)?n+i:(u||(u=.3*r),o<Math.abs(i)?(o=i,s=u/4):s=u/(2*Math.PI)*Math.asin(i/o),-(o*Math.pow(2,10*(e-=1))*Math.sin((e*r-s)*(2*Math.PI)/u))+n)},easeOutElastic:function(t,e,n,i,r){var o,u,s;return s=1.70158,u=0,o=i,0===e?n:1===(e/=r)?n+i:(u||(u=.3*r),o<Math.abs(i)?(o=i,s=u/4):s=u/(2*Math.PI)*Math.asin(i/o),o*Math.pow(2,-10*e)*Math.sin((e*r-s)*(2*Math.PI)/u)+i+n)},easeInOutElastic:function(t,e,n,i,r){var o,u,s;return s=1.70158,u=0,o=i,0===e?n:2===(e/=r/2)?n+i:(u||(u=r*(.3*1.5)),o<Math.abs(i)?(o=i,s=u/4):s=u/(2*Math.PI)*Math.asin(i/o),1>e?-.5*(o*Math.pow(2,10*(e-=1))*Math.sin((e*r-s)*(2*Math.PI)/u))+n:o*Math.pow(2,-10*(e-=1))*Math.sin((e*r-s)*(2*Math.PI)/u)*.5+i+n)},easeInBack:function(t,e,n,i,r,o){return null==o&&(o=1.70158),i*(e/=r)*e*((o+1)*e-o)+n},easeOutBack:function(t,e,n,i,r,o){return null==o&&(o=1.70158),i*((e=e/r-1)*e*((o+1)*e+o)+1)+n},easeInOutBack:function(t,e,n,i,r,o){return null==o&&(o=1.70158),(e/=r/2)<1?i/2*(e*e*(((o*=1.525)+1)*e-o))+n:i/2*((e-=2)*e*(((o*=1.525)+1)*e+o)+2)+n},easeInBounce:function(e,n,i,r,o){return r-t.easing.easeOutBounce(e,o-n,0,r,o)+i},easeOutBounce:function(t,e,n,i,r){return(e/=r)<1/2.75?i*(7.5625*e*e)+n:2/2.75>e?i*(7.5625*(e-=1.5/2.75)*e+.75)+n:2.5/2.75>e?i*(7.5625*(e-=2.25/2.75)*e+.9375)+n:i*(7.5625*(e-=2.625/2.75)*e+.984375)+n},easeInOutBounce:function(e,n,i,r,o){return o/2>n?.5*t.easing.easeInBounce(e,2*n,0,r,o)+i:.5*t.easing.easeOutBounce(e,2*n-o,0,r,o)+.5*r+i}},t}),define("UI.Cookie",["$","Model","View","Collection","UI.Browser"],function($,e,n,i,r){var o,u;return o=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={isNew:!0,name:void 0,value:void 0,type:void 0},n.prototype.initialize=function(){return this.clean()},n.prototype.clean=function(){var t;return t=this.get("value"),"undefined"===t?this.collection.remove(this.set({value:void 0})):"true"===t||"false"===t?this.set({type:"boolean",value:"true"===this.get("value")}):isNaN(t)?void 0:this.set({type:"number",value:+t})},n}(e),new(u=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=o,n.prototype.initialize=function(){var t,e,n,i,o,u,s;if(window.localStorage){if(e=localStorage.getItem("UIdate"),e&&(new Date).toDateString()!==new Date(e).toDateString()&&(localStorage.removeItem("UI"),localStorage.removeItem("UIdate")),t=localStorage.getItem("UI"))for(s=t.split(";"),o=0,u=s.length;u>o;o++)i=s[o],n=i.split(":"),this.add({name:n[0],value:n[1]});return this.on("add change remove",r.debounce(this.save,600))}},n.prototype.select=function(t){return this.findWhere({name:t})},n.prototype.bind=function(t,e,n){var i,r;return i=this.select(n+e),i?(r={},r[e]=i.get("value"),t.set(r)):i=this.add({name:n+e,value:t.get(e)}).last(),t.on("change:"+e,function(){return i.set({value:t.get(e)})})},n.prototype.sync=function(t,e,n){var i,r,o,u;for(e=$.trim(e).replace(/\s+/," ").split(" "),u=[],i=0,r=e.length;r>i;i++)o=e[i],u.push(this.bind(t,o,n));return u},n.prototype.save=function(){var t,e;return e="",t=this.length-1,this.each(function(n,i){var r;return r=i!==t?";":"",e+=n.get("name")+":"+n.get("value")+r}),localStorage.setItem("UI",e),localStorage.setItem("UIdate",(new Date).toString())},n}(i))}),define("UI.Modal",["Model"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={state:"hidden",duration:600},n.prototype.initialize=function(){return this.timeouts=[],this.clear().on("show",this.show).on("hide",this.hide)},n.prototype.clear=function(){var t,e,n,i;for(n=this.timeouts,t=0,e=n.length;e>t;t++)i=n[t],clearTimeout(i);return this.timeouts=[],this},n.prototype.show=function(){return"show"===this.get("state")||"shown"===this.get("state")?this:(this.clear().set({state:"show"}),this.timeouts.push(setTimeout(function(t){return function(){return t.set({state:"shown"})}}(this),this.get("duration"))))},n.prototype.hide=function(){return"hide"!==this.get("state")&&"hidden"!==this.get("state")?(this.clear().set({state:"hide"}),this.timeouts.push(setTimeout(function(t){return function(){return t.set({state:"hidden"})}}(this),this.get("duration")))):void 0},n}(e)}),define("UI.Events.Drag",["$"],function($){var t,e,n;return e=/(Android)/g.test(navigator.userAgent),n="ontouchstart"in window||"onmsgesturechange"in window,t=function(t){var i,r,o,u,s,a,c,h,d,l,f,p,g,v,m,y,w,_,M,I,b,k,A,E,C,z,S,x;return p=t.max||6,g=null!=t.min?t.min:15,w=null!=t.preventable?t.preventable:!0,t.$el||t.suffix?(l=$(document),h=t.$el,A=t.suffix,I=t.selector,i={},s=function(t,e,n){return i[t]=i[t]||[],i[t].push({callback:e,once:n})},M=function(){return i={}},C=function(t,e,n,r,o){var u,s,a,c,h,d,l,f,p,g;if(M=[],i[t]){for(p=i[t],s=c=0,d=p.length;d>c;s=++c)u=p[s],u.callback(e,n,r,o),u.once&&M.push(s);for(g=[],a=h=0,l=M.length;l>h;a=++h)f=M[a],g.push(i[t].splice(f-a,1));return g}},y=function(t,e){return s(t,e,!0)},o=void 0,u=void 0,_=[],S=void 0,b=void 0,E=function(t){return _.length===p&&_.splice(0,1),_.push({pageX:t.pageX,pageY:t.pageY,time:new Date})},x=function(t){var e,n;return n=_[_.length-1],e=_[0],(n[t]-e[t])/(n.time-e.time)},d=function(t){return _[_.length-1][t]-_[0][t]},r=function(t){return o=t.pageX,u=t.pageY,_=[],S=void 0,b=new Date,E(t),C("start",t.pageX,t.pageY),n||l.on("mousemove"+A,function(t){return E(t),f()?(w&&t.preventDefault(),k(t)):void 0}),n?void 0:l.on("mouseup"+A,function(t){return w&&t.preventDefault(),c(t)})},k=function(t){return C("move",t.pageX-o,t.pageY-u)},c=function(t){var e,i,r,o,u;return n||l.off("mousemove"+A+" mouseup"+A),o=f()?x("pageX"):0,u=f()?x("pageY"):0,e=Math.abs(d("pageX")),i=Math.abs(d("pageY")),r=new Date-b,e>=g||i>=g||r>500?C("end",o,u,r,t):void 0},f="y"===t.prevent?function(){if("boolean"==typeof S)return S;if(_.length>1&&e)S=Math.abs(d("pageX"))/Math.abs(d("pageY"))>.5;else{if(_.length<3)return!1;S=Math.abs(d("pageX"))/Math.abs(d("pageY"))>1}return S}:"x"===t.prevent?function(){return"boolean"==typeof S?S:_.length<3?!1:S=Math.abs(d("pageY"))/Math.abs(d("pageX"))>1}:function(){return!0},h[0]&&h[0].addEventListener&&(h.on("touchstart"+A,I,function(t){return t=t.originalEvent,r(t.targetTouches[0])}),h.on("touchmove"+A,I,function(t){return t=t.originalEvent,E(t.targetTouches[0]),f()?(w&&t.preventDefault(),k(t.targetTouches[0])):void 0}),h.on("touchend"+A,I,function(t){return c(t)})),m=function(){var e;return e=null!=I?h.find(I):h,"y"===t.prevent?e.css("-ms-touch-action","pan-y"):"x"===t.prevent?e.css("-ms-touch-action","pan-x"):e.css("-ms-touch-action","none"),e},navigator.pointerEnabled||navigator.msPointerEnabled?(a=m(),v=function(t){return E(t),f()?(w&&t.preventDefault(),k(t)):void 0},z=function(t){return c(t),window.removeEventListener("MSPointerMove",v),window.removeEventListener("MSPointerUp",z)},a.each(function(){var t;return t=$(this)[0],t.addEventListener("MSPointerDown",function(t){return r(t),window.addEventListener("MSPointerMove",v),window.addEventListener("MSPointerUp",z)})})):n||h.on("mousedown"+A,I,function(t){return 2!==t.button?(w&&t.preventDefault(),r(t)):void 0}),{on:s,off:M,trigger:C,once:y}):{on:function(){},trigger:function(){},off:function(){}}}}),define("UI.Events",["UI.Events.Drag","UI.Browser","$"],function(t,e,$){var n,i,r;return r=0,i=void 0,n={Drag:t,touch:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n})),this._drag.on("start",i)},touching:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n})),this._drag.on("move",i)},touched:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n})),this._drag.on("end",i),delete this._drag},swipe:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n,prevent:"y"})),this._drag.on("start",i)},swiping:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n,prevent:"y"})),this._drag.on("move",i)},swiped:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n,prevent:"y"})),this._drag.on("end",i),delete this._drag},pan:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n,prevent:"x"})),this._drag.on("start",i)},panning:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n,prevent:"x"})),this._drag.on("move",i)},panned:function(e,n,i){return this._drag||(this._drag=t({$el:this.$el,suffix:e,selector:n,prevent:"x"})),this._drag.on("end",i),delete this._drag},tap:function(t,e,n){return this.$el.on("mousedown"+t,e,function(i){return function(r){var o,u,s;return u=r.pageX,s=r.pageY,1===r.which?(o=setTimeout(function(){return i.$el.off("mouseup"+t)},500),i.$el.one("mouseup"+t,e,function(t){var e,i,r,o;return r=t.pageX,o=t.pageY,e=Math.abs(r-u),i=Math.abs(o-s),15>e&&15>i?n(t):void 0})):void 0}}(this))},hold:function(t,e,n){return this.$el.on("mousedown"+t,e,function(){var t;return t=setTimeout(function(){return n()},1e3),$(document).one("mouseup",function(){return clearTimeout(t)})})}},(e.is.IOS()||e.is.android())&&(n.click=function(n,i,r){var o;return o=function(o){return function(){var u;switch(o.$el.off("click"+n+" mousedown"+n+" touchstart"+n+" touchmove"+n+" touchend"+n,i),u=e.get("input")||"touch"){case"mouse":return o.$el.on("click"+n,i,r);case"touch":return o._drag=t({
$el:o.$el,suffix:n,selector:i,min:0,preventable:!1,ms:!1}),o._drag.on("end",function(t,e,n,i){return 200>n&&isNaN(t)&&isNaN(e)?r(i):void 0})}}}(this),o(),e.on("change:input",o),this.unlisten.push(function(){return e.off("change:input",o)})}),n}),define("UI",["UI.Browser","UI.Middle","UI.Toggle","UI.Animator","UI.Cookie","UI.Modal","UI.Events"],function(t,e,n,i,r,o,u){return window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return setTimeout(t,15)},window.cancelAnimationFrame=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return clearTimeout(t)},{Browser:t,Middle:e,Toggle:n,Animate:i,Cookie:r,Modal:o,Events:u}}),define("BE.Models.Logic",["Model","Data"],function(e,n){var i,r,o,u;return u=n.logic,r=n.foundation,i=n.alternate,o=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return t(o,e),o.prototype.defaults={track:void 0,coverage:void 0,finish:void 0,concern:void 0,skintype:void 0,shade:void 0,undertone:void 0,family:void 0,brush:void 0,products:void 0,foundation:void 0,showing:0},o.prototype.initialize=function(){return this.set({brush:[],products:[],foundation:[]}),this.on("change:coverage change:finish change:concern change:skintype",this.match),this.on("change:shade change:undertone change:family",this.shade),this.on("change:family",this.shades),this.on("change:brush change:products change:foundation",this.ids),this.on("change:family change:foundation",this.brush)},o.prototype.clean=function(t){return null!=t?t.toLowerCase().replace(/[^a-z]/g,""):void 0},o.prototype.match=function(){var t,e,n,i;return e=this.clean(this.get("coverage")),n=this.clean(this.get("finish")),t=this.clean(this.get("concern")),i=this.clean(this.get("skintype")),null!=e&&null!=n&&null!=i&&null!=t&&null!=u[e]&&u[e][n]&&u[e][n][t]&&u[e][n][t][i]?this.set(u[e][n][t][i]):this.set({brush:[],products:[],family:[]})},o.prototype.shade=function(){var t,e,n,o,u,s;return n=this.get("family"),u=this.clean(this.get("shade")),s=this.get("undertone"),o=[],null!=n&&null!=u&&null!=s&&(t=this.clean(n[0]),r[t]&&r[t][u]&&r[t][u][s]&&(o.push(r[t][u][s]),e=this.clean(n[1]),i[o[0]]&&i[o[0]][e]&&o.push(i[o[0]][e]))),this.set({foundation:o})},o.prototype.shades=function(){var t,e,n,i,o;e=this.get("family")[0],o=r[this.clean(e)],t=[];for(n in o)i=o[n],t.push({id:n,options:i});return this.set({shades:t})},o.prototype.brush=function(){var t,e,i;return e=this.get("family")[0],i=this.get("foundation"),t=this.get("brush"),e&&i&&i.length&&t&&(!t.length||this.get("usingDefault"))&&n.defaults[this.clean(e)]?this.set(_.extend({usingDefault:!0},n.defaults[this.clean(e)])):void 0},o.prototype.ids=function(){var t,e,n,i,r,o,u,s,a,c,h,d,l;for(n=[],h=this.get("foundation"),i=0,o=h.length;o>i;i++)e=h[i],n.push({type:ShadeFinder.text.productType.foundation,id:e});for(d=this.get("brush"),r=0,u=d.length;u>r;r++)t=d[r],n.push({type:ShadeFinder.text.productType.brush,id:t});for(l=this.get("products"),c=0,s=l.length;s>c;c++)a=l[c],n.push({type:ShadeFinder.text.productType.product,id:a});return this.set({ids:n})},o}(e)}),define("BE.Models.Product",["Model"],function(e){var n;return n=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={id:void 0,type:void 0,name:void 0,shortDescription:void 0,longDescription:void 0,pricing:void 0,availability:void 0,subtitle:void 0,imageUrl:void 0,thumbnailUrl:void 0,url:void 0,isAvailable:void 0,video:void 0,added:!1,master:!1,color:void 0,foundation:void 0,price:void 0,addedToSidebar:!1},n.prototype.initialize=function(){return this.refresh()},n.prototype.refresh=function(){var t,e,n,i,r,o;return n=this.get("name"),n=n?n.split(" - ")[0]:"",r=/broad spectrum spf (\d{0,3})/gi,n.match(r)?(i=n.match(r)[0],t=n.replace(r,""),e='<span class="heading">'+n.replace(r,"")+"</span>",o='<span class="sub">'+i+"</span> ",n=e+o,this.set({name:n,foundation:t})):(this.set({name:'<span class="heading">'+n+"</span>"}),this.set({foundation:n}))},n.prototype.addToCart=function(t){return this.get("added")?void 0:this.set({added:!0}).trigger("cart",this.id,t)},n}(e)}),define("BE.Collections.Product",["Model","Collection","BE.Models.Product","Data"],function(e,n,i,r){var o,u,s,a,c;return a=ShadeFinder.prefix,c=ShadeFinder.urls.products,s={name:ShadeFinder.text.notFound,isAvailable:!1},u=new e,o=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=i,n.prototype.initialize=function(){return this.requests=[],u.on("change:loading",function(t){return function(){return t.trigger("changeLoading",u.get("loading"))}}(this))},n.prototype.abort=function(){var t,e,n,i;for(n=this.requests,t=0,e=n.length;e>t;t++)i=n[t],i.abort();return this.requests=[]},n.prototype.sync=function(t,e,n){var i,o,u,s,a,c;for(a=[],c=this.ids,o=0,u=c.length;u>o;o++)i=c[o],null!=r.products[i]&&(s=r.products[i],a.push({title:s,id:i}));return n.success(a)},n.prototype.sync=function(t,e,n){var i,r,o,h,d,l,f,p,g;for(u.set({loading:!0}),this.abort(),d=[],f=this.ids.length,i=function(t){return function(e){return d.push(e),0===--f?(t.add(d).trigger("sync"),u.set({loading:!1})):void 0}}(this),g=function(t){return function(e){var n,r;return(n=t.findWhere({id:e.id}))?i(n):(r=$.getJSON(c+a+e.id,function(t){return i(_.extend(e,t))}),r.fail(function(){return i(_.extend(e,s))}),t.requests.push(r))}}(this),l=this.ids,p=[],o=0,h=l.length;h>o;o++)r=l[o],p.push(g(r));return p},n.prototype.retrieve=function(t){return this.ids=t,this.fetch()},n}(n)}),define("$",function(){return $}),define("Model",function(){return Backbone.Model}),define("View",function(){return Backbone.View}),define("Collection",function(){return Backbone.Collection}),require(["$","UI","Model","View","Collection","Data","BE.Models.Logic","BE.Collections.Product"],function($,e,n,i,r,o,u,s){var a,c,h,d,l,f,p,g,v,m,y,w,M,I,b,k,A,E;c=o.logic,a=o.foundation,g=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return new v({model:this})},n.prototype.test=function(t){var e,n,i;return n=[],i=[],e=[],$('.track-1 input[name="coverage"]').each(function(r){return n[0]=$(this).val(),$(this).prop("checked",!0).change(),$('.track-1 input[name="finish"]').each(function(r){return n[1]=$(this).val(),$(this).prop("checked",!0).change(),$('.track-1 input[name="concern"]').each(function(r){return n[2]=$(this).val(),$(this).prop("checked",!0).change(),$('.track-1 input[name="skintype"]').each(function(r){return n[3]=$(this).val(),$(this).prop("checked",!0).change(),$('.track-1 input[name="shade"]').each(function(r){return n[4]=$(this).val(),$(this).prop("checked",!0).change(),$('.track-1 input[name="undertone"]').each(function(r){return n[5]=$(this).val(),$(this).prop("checked",!0).change(),null!=t.get("brush")&&null!=t.get("products")&&null!=t.get("foundation")?i.push(n.join(" - ")):e.push(n.join(" - "))})})})})})}),this.set({success:i,fail:e}),this.trigger("render")},n}(n),v=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=_.template('<h2 class="green"><%= success.length %> Successful</h2><h2><%= fail.length %> Failed</h2><div class="failed"><% _.each(fail, function(f) { %><p class="failed"><%= f %></p><% }); %></div>'),n.prototype.initialize=function(){return this.model.on("create",this.create,this),this.model.on("render",this.render,this)},n.prototype.create=function(t){this.$el=t},n.prototype.render=function(){return this.$el.find(".test-result").html(this.template(this.model.attributes))},n}(i),d=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={id:void 0,title:void 0},n.prototype.initialize=function(){return new f({model:this})},n}(n),f=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=_.template("<p><%= title %> (<%= id %>)</p>"),n.prototype.initialize=function(){return this.model.on("create",this.create,this)},n.prototype.create=function(t){return t.append(this.template(this.model.attributes)),this.$el=t.find("p").last()},n}(i),p=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=d,n.prototype.sync=function(t,e,n){var i,r,u,s,a,c;for(a=[],c=this.ids,i=0,r=c.length;r>i;i++)u=c[i],null!=o.products[u.id]&&(s=o.products[u.id],a.push({title:s,id:u.id}));return n.success(a)},n.prototype.retrieve=function(t){return this.ids=t,this.fetch()},n}(r),m=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.defaults={undertone:void 0,family:void 0,shade:void 0,undertones:void 0},n.prototype.initialize=function(){return new y({model:this}),this.on("change:family change:shade",this.undertones)},n.prototype.clean=function(t){return null!=t?t.toLowerCase().replace(/[^a-z]/g,""):void 0},n.prototype.undertones=function(){var t,e,n;return t=this.clean(this.get("family")),e=this.clean(this.get("shade")),a[t]&&a[t][e]?(n=a[t][e],this.set({undertones:n})):this.set({undertones:[]})},n}(n),y=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=_.template('<% _.each(undertones, function(u, key) { %><label><%= key %></label> <input type="radio" name="undertone" value="<%= key %>" <% if (undertone === key) print("checked"); %>><% }); %>'),n.prototype.initialize=function(){return this.model.on("create",this.create,this),this.model.on("change:undertones",this.render,this)},n.prototype.create=function(t){return this.$el=t,this.delegateEvents()},n.prototype.render=function(){return this.$el.html(this.template(this.model.attributes))},n.prototype.events={"change input":function(t){var e;return e=$(t.currentTarget),this.model.set({undertone:e.val()})}},n}(i),h=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=_.template('<% if (family && _.isArray(family) && family.length) { %><h2>Family</h2><% _.each(family, function(f) { %><p><%= f %></p><% }); %><% } else if (family && _.isString(family)) { %><h2>Family</h2><p><%= family %></p><% } %><% if (brush && brush.length) { %><h2>Brush</h2><% _.each(brush, function(f) { %><div data-id="<%= f %>"></div><% }); %><% } %><% if (products && products.length) { %><h2>Cross sells</h2><% _.each(products, function(f) { %><div data-id="<%= f %>"></div><% }); %><% } %><% if (foundation && foundation.length) { %><h2>Foundation</h2><% _.each(foundation, function(f) { %><div data-id="<%= f %>"></div><% }); %><% } %>'),n.prototype.initialize=function(){return this.model.on("create",this.create,this)},n.prototype.create=function(t){return this.$el=t,this.delegateEvents()},n.prototype.update=function(t){return this.$el.find(".found").html(this.template(this.model.attributes)),t.each(function(t){return function(e){return e.trigger("create",t.$el.find('[data-id="'+e.get("id")+'"]'))}}(this))},n.prototype.coverage=function(){var t;return t=this.$el.find('input[name="coverage"]:checked'),this.model.set({coverage:t.val()})},n.prototype.finish=function(){var t;return t=this.$el.find('input[name="finish"]:checked'),this.model.set({finish:t.val()})},n.prototype.concern=function(){var t;return t=this.$el.find('input[name="concern"]:checked'),this.model.set({concern:t.val()})},n.prototype.skintype=function(){var t;return t=this.$el.find('input[name="skintype"]:checked'),this.model.set({skintype:t.val()})},n.prototype.shade=function(){var t;return t=this.$el.find('input[name="shade"]:checked'),this.model.set({shade:t.val()})},n.prototype.undertone=function(){var t;return t=this.$el.find('input[name="undertone"]:checked'),this.model.set({undertone:t.val()})},n.prototype.family=function(){var t;return t=this.$el.find('input[name="family"]:checked'),this.model.set({family:[t.val()]})},n.prototype.events={'change input[name="coverage"]':"coverage",'change input[name="finish"]':"finish",'change input[name="concern"]':"concern",'change input[name="skintype"]':"skintype",'change input[name="shade"]':"shade",'change input[name="undertone"]':"undertone",'change input[name="family"]':"family","click .test":function(){return this.model.trigger("test",this.model)}},n}(i),l=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=_.template('<div class="product-view even-<%= even %>" data-id="<%= id %>"><% if (isAvailable) { %><a class="product-image" target="_blank" href="<%=url %>"><% if (imageUrl) { %><img src="<%= imageUrl %>" /><% } %></a><% } else { %><div class="product-image"><% if (imageUrl) { %><img src="<%= imageUrl %>" /><% } %></div><% } %><div class="product-content"><% if (isAvailable) { %><a class="name" target="_blank" href="<%=url %>"><%= name %><% if (color) { %><span class="color"><%= color %></span><% } %></a><% if (subtitle) { %><div class="subtitle"><%= subtitle %></div><% } %><% } else { %><div class="name"><%= id %> is not available</div><% } %><% if (price) { %><div class="price"><%= price %></div><% } else { %><div class="price">N/A</div><% } %><% if (master) { %><button class="learn-more" href="<%=url %>">'+ShadeFinder.text.learnMore+'</button><% } else if (added) { %><button class="disabled" readonly>'+ShadeFinder.text.addedToBag+'</button><% } else if (isAvailable) { %><button class="add" data-id="<%= id %>">'+ShadeFinder.text.addToBag+'</button><% } else { %><button class="disabled" readonly>'+ShadeFinder.text.notAvailable+'</button><% } %><% if (type === "foundation" && video) { %><a class="video" data-video="<%= video %>">'+ShadeFinder.text.watchVideo+"</a><% } %></div></div>"),n.prototype.initialize=function(){return this.model.on("create",this.create,this)},n.prototype.create=function(t){return t.append(this.template(this.model.attributes)),this.$el=t.find(".product-view").last()},n}(i),A=new s,w=[],E=o.products;for(b in E)k=E[b],w.push({id:b});return I=0,A.on("add",function(t){return t.set({even:I++%2}),new l({model:t}),t.trigger("create",$("#ProductList"))}),M=function(t){var e,n,i,r,o;return e=new u,o=new h({model:e}),n=new p,i=new g,r=new m,e.on("change:ids",function(){return n.retrieve(e.get("ids"))}),n.on("sync",function(t){return o.update(n)}),e.on("test",function(){return e.off("change:ids"),i.test(e),e.on("change:ids",function(){return n.retrieve(e.get("ids"))})}),e.on("change:family change:shade",function(){var t;return e.get("family")?(t=_.isArray(e.get("family"))?e.get("family"):[e.get("family")],r.set({family:t[0],shade:e.get("shade")})):void 0}),$(function(){return e.trigger("create",$(t)),i.trigger("create",$(t+" .test")),r.trigger("create",$(t+" .undertones"))})},M(".track-1"),M(".track-2"),$(function(){return A.retrieve(w)})})}).call(this);